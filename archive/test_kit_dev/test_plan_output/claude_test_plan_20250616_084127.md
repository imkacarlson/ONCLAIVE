# Consolidated Test Plan for Plan Net

## Generated on: 2025-06-16 08:41:40

## API Type: claude

## Table of Contents

- [Organization](#organization)
  - [REQ-34: Organization search by name](#req-34)
- [OrganizationAffiliation](#organizationaffiliation)
  - [REQ-36: Organization search by specialty](#req-36)
- [Plan-Net Organization](#plan-net-organization)
  - [REQ-38: Network contact handling for departments](#req-38)
- [PractitionerRole](#practitionerrole)
  - [REQ-35: Provider search by specialty](#req-35)
- [PractitionerRole, OrganizationAffiliation](#practitionerrole,-organizationaffiliation)
  - [REQ-37: Search for active practitioners and organizations](#req-37)

## Test Specifications

<a id='organization'></a>

## Organization

<a id='req-34'></a>

### REQ-34: Organization search by name

**Description**: "The Plan-Net design is based around the following types of searches: Organization by Name - Example: Montgomery Cardiology or CVS - Focal Resource and Field: Organization.name - Qualifications of Search: Location, network, specialty."

**Actor**: Health Plan API

**Conformance**: None (Design requirement)

# Test Specification for REQ-34: Organization Search by Name

## 1. Requirement ID
REQ-34

## 2. Requirement Analysis

### Testability Assessment
- **Classification**: Automatically Testable
- **Rationale**: The requirement involves concrete, testable API functionality (organization search by name) that can be validated through automated testing.

### Complexity
- **Level**: Moderate
- **Rationale**: While the basic name search is straightforward, the requirement involves testing multiple scenarios including various qualifications (Location, network, specialty) and different name patterns.

### Prerequisites
1. Test environment with FHIR server implementing Plan-Net IG
2. Sample Organization resources in the test system including:
   - Healthcare provider organizations (e.g., "Montgomery Cardiology")
   - Retail organizations (e.g., "CVS")
   - Organizations with various specialties
   - Organizations in different locations/networks

## 3. Test Implementation Strategy

### Required Test Data
**Sample Organization Resources:**
```json
{
  "resourceType": "Organization",
  "name": "Montgomery Cardiology",
  "type": [
    {
      "coding": [
        {
          "system": "http://terminology.hl7.org/CodeSystem/organization-type",
          "code": "prov",
          "display": "Healthcare Provider"
        }
      ]
    }
  ]
}
```

### Required FHIR Operations
1. GET [base]/Organization?name=[string]
2. GET [base]/Organization?name=[string]&_include=Organization:location
3. GET [base]/Organization?name=[string]&_include=Organization:network
4. GET [base]/Organization?name=[string]&type=[code]

### Test Scenarios

#### Basic Name Search Tests
1. **Exact Match Search**
   - Input: GET [base]/Organization?name=Montgomery Cardiology
   - Expected: Returns exact matching organization
   
2. **Partial Match Search**
   - Input: GET [base]/Organization?name=Montgomery
   - Expected: Returns organizations containing "Montgomery"

3. **Case Insensitive Search**
   - Input: GET [base]/Organization?name=montgomery cardiology
   - Expected: Returns matching organization regardless of case

#### Qualified Search Tests
1. **Search with Location**
   - Input: GET [base]/Organization?name=CVS&_include=Organization:location
   - Expected: Returns matching organizations with included location resources

2. **Search with Network**
   - Input: GET [base]/Organization?name=Montgomery&_include=Organization:network
   - Expected: Returns matching organizations with included network information

3. **Search with Specialty**
   - Input: GET [base]/Organization?name=Montgomery&type=prov
   - Expected: Returns matching healthcare provider organizations

### Validation Criteria

#### Response Format Validation
1. Verify response is a valid FHIR Bundle
2. Verify each entry contains valid Organization resource
3. Verify HTTP 200 OK status code

#### Content Validation
1. Verify returned organizations contain the searched name (exact or partial match)
2. Verify included resources (Location, Network) are properly linked
3. Verify search is case-insensitive
4. Verify proper handling of special characters in organization names

#### Error Handling
1. Verify appropriate error response for malformed queries
2. Verify handling of non-existent organization names
3. Verify proper handling of pagination for large result sets

### Test Data Requirements
1. Minimum of 5 test organizations with various names
2. Mix of healthcare providers and retail organizations
3. Organizations with associated location and network information
4. Organizations with different specialties

### Testing Notes
- All searches must use the supported search parameter 'name' as confirmed in the Capability Statement
- Tests should verify both exact and partial matching behavior
- Consider testing with special characters and international characters in organization names
- Verify proper handling of white space in organization names

---



<a id='organizationaffiliation'></a>

## OrganizationAffiliation

<a id='req-36'></a>

### REQ-36: Organization search by specialty

**Description**: "The Plan-Net design is based around the following types of searches: Organization by specialty - Example: Compounding Pharmacy - Focal Resource and Field: OrganizationAffiliation.specialty - Qualifications of Search: Location, network, name."

**Actor**: Health Plan API

**Conformance**: None (Design requirement)

# Test Specification for REQ-36: Organization Search by Specialty

## 1. Requirement ID
REQ-36: Organization search by specialty

## 2. Requirement Analysis

### Testability Assessment
- **Classification**: Automatically Testable
- **Complexity**: Moderate
- **Rationale**: The requirement involves testing search capabilities across multiple FHIR resources (OrganizationAffiliation, Organization) with multiple parameters, making it programmatically testable but requiring careful setup and validation.

### Prerequisites
1. Test environment with FHIR server implementing Plan-Net IG
2. Sample data setup including:
   - Organizations with various specialties
   - OrganizationAffiliation resources linking to these Organizations
   - Associated Location resources
   - Network resources
   - At least one Organization with Compounding Pharmacy specialty

## 3. Test Implementation Strategy

### Required Resources
1. Organization resources with various specialties
2. OrganizationAffiliation resources with specialty codes
3. Location resources linked to Organizations
4. Network resources for testing network-based filtering

### Test Scenarios

#### Scenario 1: Basic Specialty Search
```
Operation: GET [base]/OrganizationAffiliation?specialty=compounding-pharmacy
Expected Result: Returns OrganizationAffiliation resources with compounding pharmacy specialty
```

#### Scenario 2: Specialty + Location Search
```
Operation: GET [base]/OrganizationAffiliation?specialty=compounding-pharmacy&location=[location-reference]
Expected Result: Returns OrganizationAffiliation resources filtered by both specialty and location
```

#### Scenario 3: Specialty + Network Search
```
Operation: GET [base]/OrganizationAffiliation?specialty=compounding-pharmacy&network=[network-reference]
Expected Result: Returns OrganizationAffiliation resources filtered by both specialty and network
```

#### Scenario 4: Specialty + Organization Name Search
```
Operation: GET [base]/OrganizationAffiliation?specialty=compounding-pharmacy&participating-organization.name=[name]
Expected Result: Returns OrganizationAffiliation resources filtered by specialty and organization name
```

### Validation Criteria

For each test scenario, verify:

1. **Response Status**
   - 200 OK for successful searches
   - Appropriate error codes for invalid parameters

2. **Response Content**
   - Returns Bundle resource
   - Each entry contains valid OrganizationAffiliation resource
   - Specialty codes match the search criteria
   - Referenced Organizations exist and are accessible

3. **Search Parameter Validation**
   - specialty parameter works as token type
   - Combinations of parameters work as expected
   - Search results are properly filtered

4. **Resource Relationships**
   - OrganizationAffiliation.specialty contains the searched specialty code
   - Referenced Organizations are valid
   - Location references are valid when included
   - Network references are valid when included

### Implementation Notes

1. **Supported Parameters** (from Capability Statement):
   - OrganizationAffiliation.specialty (SHALL support)
   - OrganizationAffiliation.location (SHALL support)
   - OrganizationAffiliation.network (SHALL support)
   - Organization.name (SHALL support)

2. **Test Data Requirements**:
   - Must include valid SNOMED CT or other approved code system values for specialties
   - Must have proper resource references between Organization, OrganizationAffiliation, Location, and Network resources

3. **Error Conditions to Test**:
   - Invalid specialty codes
   - Non-existent location references
   - Non-existent network references
   - Malformed search parameters

---



<a id='plan-net-organization'></a>

## Plan-Net Organization

<a id='req-38'></a>

### REQ-38: Network contact handling for departments

**Description**: "When the contact is a department name, rather than a human (e.g., patient help line), include a blank family and given name, and provide the department name in contact.name.text."

**Actor**: Health Plan API

**Conformance**: None (Implementation guidance)

# Test Specification for REQ-38

## 1. Requirement ID
REQ-38: Network contact handling for departments

## 2. Requirement Analysis

### Testability Assessment
- **Classification**: Automatically testable with manual verification component
- **Justification**: While automated validation of the data structure is possible, human verification may be needed to confirm the business context of department vs individual contacts

### Complexity
- **Level**: Moderate
- **Rationale**: Requires testing multiple scenarios and validating specific structural elements within contact information, but logic is straightforward

### Prerequisites
- Access to Health Plan API endpoint
- Test data containing department-based contacts
- Test data containing individual-based contacts (for comparison)
- Ability to create or modify contact information in test environment

## 3. Test Implementation Strategy

### Required Inputs

#### Test Data Scenarios
1. Department Contact Example:
```json
{
  "name": {
    "text": "Patient Help Line",
    "family": "",
    "given": []
  }
}
```

2. Individual Contact Example (for comparison):
```json
{
  "name": {
    "family": "Smith",
    "given": ["John"],
    "text": "John Smith"
  }
}
```

### Required FHIR Operations
- GET operations to retrieve resources containing contact information
- Optional: POST/PUT operations if testing contact creation/updates

### Validation Criteria

#### Structural Validation
1. For department contacts:
   - Verify name.family is present but empty string
   - Verify name.given is present but empty array
   - Verify name.text contains non-empty department name
   - Verify department name follows organizational naming conventions

2. Data Consistency:
   - Verify the contact information appears in appropriate locations within the resource
   - Verify no conflicting information exists between text and structured name fields

#### Business Validation
1. Manual review to confirm:
   - The contact is actually a department (not misclassified individual)
   - Department name in text field is appropriate and recognizable
   - Contact information adheres to organization's naming standards

### Test Cases

1. **Basic Department Contact**
   - Input: Create contact for "Emergency Department"
   - Expected Result: Contact structured correctly with empty family/given names and department in text

2. **Department with Special Characters**
   - Input: Create contact for "Pediatrics & Neonatal Unit"
   - Expected Result: Special characters handled correctly in text field

3. **Convert Individual to Department**
   - Input: Modify existing individual contact to department
   - Expected Result: Structure updated correctly

4. **Edge Cases**
   - Empty department name
   - Very long department names
   - Department names with multiple lines or special formatting

### Success Criteria
- All structural validations pass
- Business validation confirms correct usage
- Edge cases handled appropriately
- No unintended side effects on other contact information

### Test Data Management
- Maintain set of test data representing various department types
- Include both valid and invalid test cases
- Document expected results for each test case

---



<a id='practitionerrole'></a>

## PractitionerRole

<a id='req-35'></a>

### REQ-35: Provider search by specialty

**Description**: "The Plan-Net design is based around the following types of searches: Provider by Specialty - Example: Cardiologist - Focal Resource and Field: PractitionerRole.specialty - Qualifications of Search: Location, network, name."

**Actor**: Health Plan API

**Conformance**: None (Design requirement)

# Test Specification for REQ-35: Provider Search by Specialty

## 1. Requirement ID
REQ-35: Provider search by specialty

## 2. Requirement Analysis

### Testability Assessment
- **Classification**: Automatically Testable
- **Justification**: The requirement involves concrete search operations using defined FHIR search parameters that are explicitly supported in the Capability Statement.

### Complexity
- **Level**: Moderate
- **Rationale**: While the basic specialty search is straightforward, the requirement involves multiple optional qualifiers (location, network, name) and requires verification of proper resource relationships.

### Prerequisites
1. Test environment with FHIR server implementing Plan-Net IG
2. Sample data including:
   - PractitionerRole resources with specialty codes
   - Associated Practitioner resources
   - Associated Location resources
   - Associated Network resources
3. Valid specialty codes (e.g., NUCC or SNOMED CT codes for specialties)
4. Test data must include at least:
   - Multiple practitioners with different specialties
   - Multiple locations
   - Multiple networks

## 3. Test Implementation Strategy

### Required Resources
- PractitionerRole (primary test resource)
- Practitioner (referenced resource)
- Location (for location-based filtering)
- Organization (for network references)

### Test Scenarios

#### Basic Specialty Search
```
GET [base]/PractitionerRole?specialty=http://nucc.org/provider-taxonomy|207RC0000X
```
(Where 207RC0000X represents Cardiovascular Disease/Cardiology)

**Validation Criteria:**
- Response is 200 OK
- Bundle contains only PractitionerRole resources
- All returned resources have matching specialty code
- Bundle.total reflects accurate count

#### Specialty Search with Location
```
GET [base]/PractitionerRole?specialty=http://nucc.org/provider-taxonomy|207RC0000X&location=[location-id]
```

**Validation Criteria:**
- Response is 200 OK
- All returned resources have matching specialty and location reference
- Location references are valid

#### Specialty Search with Network
```
GET [base]/PractitionerRole?specialty=http://nucc.org/provider-taxonomy|207RC0000X&network=[network-id]
```

**Validation Criteria:**
- Response is 200 OK
- All returned resources have matching specialty and network reference
- Network references are valid

#### Specialty Search with Practitioner Name
```
GET [base]/PractitionerRole?specialty=http://nucc.org/provider-taxonomy|207RC0000X&practitioner.name=[name]
```

**Validation Criteria:**
- Response is 200 OK
- All returned resources have matching specialty
- Referenced Practitioner resources match the name criteria

### Edge Cases to Test
1. Search with invalid specialty code
   - Expected: 400 Bad Request or empty bundle
2. Search with valid specialty but no matching providers
   - Expected: 200 OK with empty bundle
3. Search with multiple specialty codes
   - Expected: Returns providers matching any of the specified specialties
4. Search with maximum allowed parameters
   - Expected: Correct filtering across all parameters

### Performance Considerations
- Response time should be within acceptable limits (suggest < 2 seconds)
- Results should be properly paginated if exceeding server limits
- Server should handle concurrent specialty searches

### Error Scenarios
1. Malformed specialty code
2. Invalid location reference
3. Invalid network reference
4. Missing required parameters

### Required FHIR Operations
- GET (search) on PractitionerRole endpoint
- Chained searches for related resources
- Support for _include parameter if needed for referenced resources

All operations listed are supported according to the provided Capability Statement.

---



<a id='practitionerrole,-organizationaffiliation'></a>

## PractitionerRole, OrganizationAffiliation

<a id='req-37'></a>

### REQ-37: Search for active practitioners and organizations

**Description**: "Sample query to search for currently active Practitioners (replace date in query with current date): http://davinci-plan-net-ri.logicahealth.org/fhir/PractitionerRole?_include=PractitionerRole:date=ge2021-10-25. Sample query to search for currently active Organizations (replace date in query with current date): http://davinci-plan-net-ri.logicahealth.org/fhir/OrganizationAffiliation?_include=OrganizationAffiliation:date=ge2021-10-25."

**Actor**: Health Plan API

**Conformance**: None (Implementation example)

# Test Specification for REQ-37

## 1. Requirement ID
REQ-37: Search for active practitioners and organizations

## 2. Requirement Analysis

### Testability Assessment
- **Classification**: Automatically Testable
- **Rationale**: The requirement specifies concrete API endpoints and search parameters that can be programmatically tested.

### Complexity
- **Level**: Moderate
- **Rationale**: Involves testing multiple resources (PractitionerRole and OrganizationAffiliation) with date-based filtering and _include parameters, requiring multiple test scenarios.

### Prerequisites
1. Access to the FHIR server endpoint
2. Test data including:
   - Active PractitionerRole resources with various dates
   - Active OrganizationAffiliation resources with various dates
   - Associated Practitioner and Organization resources
3. Server implementation supporting the specified search parameters
4. Valid authentication credentials (if required)

## 3. Test Implementation Strategy

### Required Test Data
1. PractitionerRole resources:
   - Some with active status and current dates
   - Some with inactive status
   - Some with past dates
2. OrganizationAffiliation resources:
   - Some with active status and current dates
   - Some with inactive status
   - Some with past dates

### Test Scenarios

#### Scenario 1: PractitionerRole Active Search
```
Test Steps:
1. Get current date in YYYY-MM-DD format
2. Construct URL: BASE_URL/PractitionerRole?date=ge[current_date]
3. Execute GET request
4. Verify response
```

**Expected Results:**
- HTTP Status: 200 OK
- Bundle resource returned
- Only active PractitionerRole resources with dates >= current date included
- Proper _include resources present if specified

#### Scenario 2: OrganizationAffiliation Active Search
```
Test Steps:
1. Get current date in YYYY-MM-DD format
2. Construct URL: BASE_URL/OrganizationAffiliation?date=ge[current_date]
3. Execute GET request
4. Verify response
```

**Expected Results:**
- HTTP Status: 200 OK
- Bundle resource returned
- Only active OrganizationAffiliation resources with dates >= current date included
- Proper _include resources present if specified

### Validation Criteria

#### Technical Validation
1. Response Format:
   - Valid FHIR Bundle
   - Correct resource types returned
   - Valid date filtering applied

2. Date Filtering:
   - Verify no resources returned with dates before the specified date
   - Verify all applicable resources after specified date are included

3. Resource Validation:
   - PractitionerRole resources contain required elements
   - OrganizationAffiliation resources contain required elements
   - Referenced resources are valid and accessible

#### Business Validation
1. Active Status:
   - Returned PractitionerRole resources should be currently active
   - Returned OrganizationAffiliation resources should be currently active

2. Date Logic:
   - Current date filtering works correctly
   - Date comparisons handle timezone differences appropriately

### Error Scenarios to Test
1. Invalid date format
2. Future dates
3. Missing required parameters
4. Invalid _include parameters

### Test Data Requirements
```json
{
  "minimumTestData": {
    "PractitionerRole": {
      "active": [
        {
          "id": "test-pr-1",
          "active": true,
          "period": {
            "start": "[current_date]",
            "end": null
          }
        }
      ],
      "inactive": [
        {
          "id": "test-pr-2",
          "active": false,
          "period": {
            "start": "2020-01-01",
            "end": "2020-12-31"
          }
        }
      ]
    },
    "OrganizationAffiliation": {
      "active": [
        {
          "id": "test-oa-1",
          "active": true,
          "period": {
            "start": "[current_date]",
            "end": null
          }
        }
      ],
      "inactive": [
        {
          "id": "test-oa-2",
          "active": false,
          "period": {
            "start": "2020-01-01",
            "end": "2020-12-31"
          }
        }
      ]
    }
  }
}
```

### Notes
- Implementation should use dynamic date generation for tests to remain valid over time
- Consider implementing date boundary testing
- Include error handling for various HTTP response codes
- Consider pagination handling for large result sets
- Test both with and without _include parameters

---



