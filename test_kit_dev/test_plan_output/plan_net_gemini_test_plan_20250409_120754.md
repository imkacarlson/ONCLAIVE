# Consolidated Test Plan for Plan Net

## Generated on: 2025-04-09 12:08:14

## Capability Statement

This test plan incorporates constraints and requirements from the Plan Net Capability Statement.

## Table of Contents

- [Client](#client)
  - [REQ-02: No PII sending by clients](#req-02)
  - [REQ-06: Client handling of Must Support data elements](#req-06)
  - [REQ-07: Client display of data elements](#req-07)
  - [REQ-08: Client interpretation of missing Must Support data](#req-08)
  - [REQ-09: Client processing of missing information indicators](#req-09)
  - [REQ-31: Client tracking of directory content updates](#req-31)
- [Server](#server)
  - [REQ-01: No PII requirement for directory queries](#req-01)
  - [REQ-03: Population of Must Support data elements](#req-03)
  - [REQ-04: Not including absent data elements](#req-04)
  - [REQ-05: Using dataAbsentReason for missing required information](#req-05)
  - [REQ-10: JSON format support](#req-10)
  - [REQ-11: RESTful behavior implementation](#req-11)
  - [REQ-12: Support for all Implementation Guide profiles](#req-12)
  - [REQ-13: Unauthorized request response](#req-13)
  - [REQ-14: Insufficient scope response](#req-14)
  - [REQ-15: Invalid parameter response](#req-15)
  - [REQ-16: Unknown resource response](#req-16)
  - [REQ-17: Deleted resource response](#req-17)
  - [REQ-18: Profile identification in meta attribute](#req-18)
  - [REQ-19: Individual search parameter support](#req-19)
  - [REQ-20: Combination search parameter support](#req-20)
  - [REQ-21: Forward chaining support](#req-21)
  - [REQ-22: Reverse chaining support](#req-22)
  - [REQ-23: XML format support](#req-23)
  - [REQ-24: Rejection of unauthorized requests](#req-24)
  - [REQ-25: Support for read interaction](#req-25)
  - [REQ-26: Support for vread interaction](#req-26)
  - [REQ-27: Support for _includes](#req-27)
  - [REQ-28: Support for _revincludes](#req-28)
  - [REQ-29: Network profile NPI handling](#req-29)
  - [REQ-30: lastUpdate timestamp requirement](#req-30)
  - [REQ-32: General Search for Pharmacy](#req-32)
  - [REQ-33: Provider search by name](#req-33)
  - [REQ-34: Organization search by name](#req-34)
  - [REQ-35: Provider search by specialty](#req-35)
  - [REQ-36: Organization search by specialty](#req-36)
  - [REQ-37: Search for active practitioners and organizations](#req-37)
  - [REQ-38: Network contact handling for departments](#req-38)
  - [REQ-39: Organization contact handling for departments](#req-39)
  - [REQ-40: Practitioner qualification coding](#req-40)

## Test Specifications

<a id='client'></a>

## Client

<a id='req-02'></a>

### REQ-02: No PII sending by clients

**Description**: "A directory mobile application SHALL NOT send consumer identifiable information when querying a Plan-Net service."

**Actor**: Client

**Conformance**: SHALL NOT

## Test Specification for REQ-02: No PII Sending by Clients

**1. Requirement ID:** REQ-02

**2. Requirement Analysis:**

   - **Testability Assessment:** Hybrid (Combination of automated network traffic analysis and manual inspection of client code/configuration)
   - **Complexity:** Moderate
   - **Prerequisites:** 
      - A deployed and running instance of the directory mobile application.
      - Access to network traffic analysis tools (e.g., Wireshark, Fiddler).
      - (Optional for enhanced validation) Access to the client application's source code or configuration files.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Network Traffic Analysis**

     - **Description:** This test case focuses on analyzing the network traffic between the client application and the Plan-Net service to ensure no PII is being transmitted.

     - **Required Inputs:**
        - A user account on the directory mobile application.
        - A pre-defined set of search criteria that would typically be used to query the Plan-Net service.

     - **Expected Outputs:**
        - Network traffic capture logs.

     - **Required FHIR Operations:**  
        - The specific FHIR operation will depend on the functionality being tested (e.g., `Patient/$search`, `Practitioner/$search`). Refer to the Capability Statement to identify the supported search operations for the Plan-Net service.

     - **Test Data Requirements:**
        - Use realistic but anonymized data for the search criteria. For example, use generalized location data ("city, state") instead of specific addresses.

     - **Validation Criteria:**
        - **Network Traffic Inspection:** Analyze the captured network traffic to ensure that no PII is present in the request payloads sent from the client application. This includes, but is not limited to:
            - Patient names
            - Patient dates of birth
            - Social Security numbers
            - Full addresses
            - Phone numbers
        - **Assertion:** All network requests from the client application to the Plan-Net service MUST NOT contain any PII.

   **3.2. Test Case 2: Client Code/Configuration Inspection (Optional)**

     - **Description:** This test case provides an additional layer of validation by directly inspecting the client application's codebase or configuration files.

     - **Required Inputs:**
        - Access to the client application's source code or configuration files.

     - **Expected Outputs:**
        - Identification of any code segments or configuration settings related to data transmission to the Plan-Net service.

     - **Validation Criteria:**
        - **Code/Configuration Review:** Manually review the relevant code sections or configuration settings to verify that no PII is being included in the data structures or parameters used for communicating with the Plan-Net service.
        - **Assertion:** The client application's code and configuration MUST NOT contain any logic or settings that explicitly include PII in requests sent to the Plan-Net service.

**Note:** 

- The specific FHIR resources and search parameters used in the test cases will depend on the functionalities offered by the Plan-Net service and the directory mobile application.
- These test cases provide a starting point and can be further expanded or modified based on the specific implementation details and risk assessment. 
- Consider using a combination of automated and manual testing approaches to achieve comprehensive coverage and efficient validation. 


---

<a id='req-06'></a>

### REQ-06: Client handling of Must Support data elements

**Description**: "Application actors SHALL be capable of processing resource instances containing the Must Support data elements without generating an error or causing the application to fail."

**Actor**: Client

**Conformance**: SHALL

## Test Specification for REQ-06: Client Handling of Must Support Data Elements

### 1. Requirement ID

REQ-06

### 2. Requirement Analysis

**Testability Assessment:**  Hybrid (Combination of Automatic and Manual)

**Complexity:** Moderate

**Prerequisites:**

* **Test Environment:** A FHIR server with the target implementation guide loaded and a client application capable of interacting with the FHIR server.
* **Test Data:**  
    * A set of valid FHIR resources relevant to the implementation guide.
    * For each resource type, variations containing:
        * All "Must Support" data elements populated with valid values.
        * A subset of "Must Support" data elements populated.
    * (Optional) Resources containing data elements marked as "Must Support" with invalid values to test error handling (this goes beyond the requirement but can be valuable).
* **Capability Statement:** Access to the target server's Capability Statement to identify resources and their "Must Support" elements.

### 3. Test Implementation Strategy

#### 3.1 Required Inputs and Expected Outputs

**Inputs:**

* FHIR resources (as described in Prerequisites) containing "Must Support" data elements.

**Expected Outputs:**

* **Successful Response:** The client application should successfully process (create, read, update, or search) the provided FHIR resources without generating errors related to the presence of "Must Support" data elements.
* **HTTP Status Codes:** The client should receive appropriate HTTP status codes from the server (e.g., 200 OK for successful read, 201 Created for successful creation).
* **No Functional Errors:** The client application should not exhibit any functional errors or unexpected behavior due to the presence of "Must Support" data elements.

#### 3.2 Required FHIR Operations

* **Read (GET):** Retrieve resources containing "Must Support" data elements.
* **Create (POST):** Create new resources containing "Must Support" data elements.
* **Update (PUT):** Update existing resources, adding or modifying "Must Support" data elements.
* **Search (GET with parameters):** Search for resources based on criteria that include "Must Support" data elements.

**Note:** The specific FHIR operations to be tested will depend on the resources and interactions defined in the implementation guide and supported by the server (as declared in the Capability Statement).

#### 3.3 Test Data Requirements

* **Realistic Data:** Use realistic and representative data for the "Must Support" elements to ensure practical handling by the client.
* **Data Variations:** Include variations in the data values and combinations of populated "Must Support" elements to ensure comprehensive testing.

#### 3.4 Validation Criteria

* **Error Logging:** Analyze client-side logs for any errors or warnings related to the processing of "Must Support" data elements.
* **Response Validation:** Verify that the client receives successful HTTP status codes and that the response content is as expected (e.g., resources are returned/created/updated correctly).
* **Functional Testing:** Manually interact with the client application to confirm that the presence of "Must Support" data elements does not cause any functional issues.

**Example Test Case:**

1. **Test ID:** TC_REQ-06_Patient_Create
2. **Description:** Verify the client can create a new Patient resource with all "Must Support" elements populated.
3. **Steps:**
    1. Retrieve the Capability Statement from the server.
    2. Identify the "Must Support" data elements for the Patient resource.
    3. Construct a new Patient resource with valid data for all "Must Support" elements.
    4. Send a POST request to the server to create the Patient resource.
4. **Expected Results:**
    1. The server responds with HTTP status code 201 Created.
    2. The response body contains the newly created Patient resource.
    3. No errors are logged on the client-side related to "Must Support" data elements. 


---

<a id='req-07'></a>

### REQ-07: Client display of data elements

**Description**: "Application actors SHOULD be capable of displaying the data elements for human use or storing the information for other purposes."

**Actor**: Client

**Conformance**: SHOULD

## Test Specification for REQ-07: Client Display of Data Elements

**1. Requirement ID:** REQ-07

**2. Requirement Analysis:**

   - **Testability Assessment:** Hybrid (Combination of Automatic and Manual)
   - **Complexity:** Moderate
   - **Prerequisites:**
     - A running instance of the Client application under test.
     - Access to test data in FHIR format.
     - A predefined set of data elements relevant to the Implementation Guide's scope.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Visual Inspection of Data Element Display**

     - **Description:** This test case verifies the Client's ability to display data elements in a human-readable format.
     - **Type:** Manual
     - **Required Inputs:**
       - Test data in FHIR format containing the predefined set of data elements.
     - **Test Steps:**
       1. Load the test data into the Client application.
       2. Visually inspect the Client's user interface to ensure that all predefined data elements are displayed clearly and understandably.
     - **Expected Outputs:**
       - All predefined data elements should be displayed in a human-readable format, including appropriate labels, formatting, and organization.
     - **Validation Criteria:**
       - Manual inspection to confirm the clarity and completeness of data element display.

   **3.2. Test Case 2: Verification of Data Element Storage (Optional)**

     - **Description:** This test case verifies the Client's ability to store data elements for potential use by other applications or processes.
     - **Type:** Automatic (if applicable) or Manual
     - **Required Inputs:**
       - Test data in FHIR format containing the predefined set of data elements.
     - **Test Steps:**
       1. Load the test data into the Client application.
       2. **Automatic:** If the Client exposes an API for data retrieval, use appropriate FHIR operations (e.g., `read`, `search`) to retrieve the stored data.
          - **Required FHIR Operations:** Dependent on the Client's Capability Statement, potentially `read` or `search`.
       2. **Manual:** If no API is available, inspect the Client's data storage mechanism (e.g., database, file system) to verify that the data elements are stored correctly.
     - **Expected Outputs:**
       - The retrieved or inspected data should match the original test data, confirming successful storage of all predefined data elements.
     - **Validation Criteria:**
       - **Automatic:** Assert that the retrieved data matches the original test data.
       - **Manual:** Manual comparison of the stored data with the original test data.

   **3.3. Test Data Requirements:**

     - The test data should be representative of real-world scenarios relevant to the Implementation Guide.
     - It should include a variety of data types and formats to ensure comprehensive testing.
     - The predefined set of data elements should cover the essential information required by the Implementation Guide.

   **3.4. Additional Considerations:**

     - The specific FHIR operations used in Test Case 2 will depend on the Client's Capability Statement. Ensure that the chosen operations are supported.
     - The level of automation achievable for Test Case 2 will depend on the Client's architecture and available interfaces.
     - The "SHOULD" conformance level of REQ-07 implies that while supporting data element display and storage is highly recommended, it might not be mandatory for all Client implementations. This flexibility should be considered during testing and reporting. 


---

<a id='req-08'></a>

### REQ-08: Client interpretation of missing Must Support data

**Description**: "When querying Health Plan API actors, Application actors SHALL interpret missing Must Support data elements within resource instances as data not present in the Health Plan API actors system."

**Actor**: Client

**Conformance**: SHALL

## Test Specification for REQ-08: Client Interpretation of Missing Must Support Data

**1. Requirement ID:** REQ-08

**2. Requirement Analysis:**

   - **Testability Assessment:** Hybrid (Combination of automated API calls and manual inspection of client behavior)
   - **Complexity:** Moderate
   - **Prerequisites:**
     - A running instance of the Health Plan API with known resources.
     - A client application capable of querying the Health Plan API.
     - The Capability Statement of the Health Plan API, indicating which elements have `MustSupport` set to `true`.
     - Access to the client application's logic or UI to verify its interpretation of missing data.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Missing Must Support Data Element**

   - **Objective:** Verify that the client application correctly interprets a missing "Must Support" data element as data not present in the Health Plan API system.

   - **Inputs:**
     - A FHIR query targeting a resource type and searching for instances that should contain the "Must Support" element.
     - The Capability Statement of the Health Plan API, identifying the specific "Must Support" element within the resource.

   - **Expected Outputs:**
     - The Health Plan API should return a response containing resources that are missing the specified "Must Support" element.
     - The client application should NOT treat the missing element as an error.
     - The client application should either:
       - Display a suitable message indicating that the data is not available.
       - Leave the corresponding field blank or with a default value.
       - Implement application-specific logic to handle the missing data gracefully.

   - **Required FHIR Operations:**
     - `GET` operation on the appropriate resource endpoint with search criteria.

   - **Test Data Requirements:**
     - Pre-populated resources in the Health Plan API where some instances are missing the targeted "Must Support" element.

   - **Validation Criteria:**
     - Verify the Health Plan API response does not contain the "Must Support" element in the returned resources.
     - Manually inspect the client application's behavior (UI or logs) to confirm it does not throw errors and handles the missing data according to the expected output.

   **3.2. Test Case 2: Present Must Support Data Element**

   - **Objective:** Verify that the client application correctly processes and displays a "Must Support" data element when it is present.

   - **Inputs:**
     - A FHIR query targeting a resource type and searching for instances that contain the "Must Support" element.
     - The Capability Statement of the Health Plan API, identifying the specific "Must Support" element within the resource.

   - **Expected Outputs:**
     - The Health Plan API should return a response containing resources with the specified "Must Support" element populated.
     - The client application should correctly process and display the value of the "Must Support" element.

   - **Required FHIR Operations:**
     - `GET` operation on the appropriate resource endpoint with search criteria.

   - **Test Data Requirements:**
     - Pre-populated resources in the Health Plan API where some instances have the targeted "Must Support" element populated with valid data.

   - **Validation Criteria:**
     - Verify the Health Plan API response contains the "Must Support" element with data in the returned resources.
     - Manually inspect the client application's UI or logs to confirm it correctly displays the value of the "Must Support" element.


**Note:** These test cases can be repeated for different resource types and "Must Support" elements as identified in the Capability Statement of the Health Plan API. 


---

<a id='req-09'></a>

### REQ-09: Client processing of missing information indicators

**Description**: "Consumer App actors SHALL be able to process resource instances containing Must Support data elements asserting missing information."

**Actor**: Client

**Conformance**: SHALL

## Test Specification for REQ-09: Client Processing of Missing Information Indicators

### 1. Requirement ID

REQ-09

### 2. Requirement Analysis

- **Testability Assessment:**  Automatic
- **Complexity:** Simple
- **Prerequisites:**
    - A FHIR server with the target Implementation Guide loaded and configured.
    - A test client capable of making FHIR API requests and parsing responses.
    - Test data containing resources with Must Support data elements asserting missing information. 

### 3. Test Implementation Strategy

#### 3.1. Test Case 1: Client Successfully Processes Resource with Missing Information

**Objective:** Verify that the client can successfully retrieve and process a resource containing Must Support data elements with missing information indicators.

**Inputs:**
- **FHIR Operation:** `read` or `search` (depending on the resource type and available search parameters).
- **Target Resource:** A resource instance containing at least one Must Support data element with a missing information indicator (e.g., dataAbsentReason extension). 

**Expected Outputs:**
- **HTTP Status Code:** 200 (OK)
- **Response Body:** The requested resource instance containing the Must Support data element with the missing information indicator.

**Validation Criteria:**
- **Assert:** The client successfully retrieves the resource with an HTTP 200 status code.
- **Assert:** The client correctly parses the response and identifies the Must Support data element with the missing information indicator.
- **Assert (Optional):** The client appropriately handles and displays the missing information to the user based on the specific dataAbsentReason value (e.g., displaying "Not applicable" or "Unknown" to the user).

#### 3.2. Test Data Requirements

- Define specific resources and Must Support data elements relevant to the Implementation Guide.
- Populate test resources with appropriate missing information indicators (e.g., dataAbsentReason extensions) according to the IG's guidance.
- Include variations of missing information reasons (e.g., "unknown", "not-applicable", "masked") to ensure comprehensive testing.

#### 3.3. Additional Considerations

- **Capability Statement Validation:** Before executing tests, verify that the target FHIR server advertises support for the required resources and search parameters in its Capability Statement.
- **Negative Testing:** Consider adding negative test cases to assess the client's behavior when encountering invalid or unexpected missing information indicators.
- **Error Handling:** Evaluate the client's error handling mechanisms for scenarios where the server returns errors related to missing information indicators.

**Note:** This test specification provides a general framework. You should tailor the specific test cases, data, and validation criteria based on the specific resources, data elements, and missing information indicator conventions defined in your FHIR Implementation Guide. 


---

<a id='req-31'></a>

### REQ-31: Client tracking of directory content updates

**Description**: "Clients that cache query results can track additions or modifications to directory content through queries that filter content using the _lastUpdated search parameter."

**Actor**: Client

**Conformance**: None (Implementation guidance)

## Test Specification for REQ-31: Client Tracking of Directory Content Updates

### 1. Requirement ID

REQ-31

### 2. Requirement Analysis

#### Testability Assessment: 
**Hybrid** (Combination of automated API calls and manual inspection of client behavior)

#### Complexity: 
**Moderate**

#### Prerequisites:

* A FHIR server implementation that conforms to the provided Implementation Guide and supports the `_lastUpdated` search parameter for relevant resources.
* A client application capable of making FHIR API calls and caching results.
* Test data consisting of at least one resource type that is expected to be updated and cached by the client.

### 3. Test Implementation Strategy

#### Required Inputs:

* **Initial Dataset:** A set of resources on the FHIR server.
* **Updated Dataset:**  Modifications or additions to the initial dataset.
* **Client Configuration:**  Details about the client's caching mechanism and how it utilizes the `_lastUpdated` parameter.

#### Expected Outputs:

* **Client Cache:** The client's local cache should reflect the updated resources after querying with the `_lastUpdated` parameter.

#### Required FHIR Operations:

1. **Initial Query:** 
    * **Operation:** `GET [base]/[resource type]`
    * **Purpose:** Retrieve the initial set of resources. This establishes a baseline for comparison.
2. **Update Resources:**
    * **Operation:** `PUT [base]/[resource type]/[id]` or `POST [base]/[resource type]`
    * **Purpose:**  Modify existing resources or add new resources to the server.
3. **Query with _lastUpdated:**
    * **Operation:** `GET [base]/[resource type]?_lastUpdated=[timestamp]`
    * **Purpose:** Retrieve resources updated after the specified timestamp. The timestamp should be set to a value before the updates were made.

#### Test Data Requirements:

* **Realistic Data:** Use representative resource types and data elements relevant to the implementation guide.
* **Timestamp Accuracy:** Ensure timestamps used in the `_lastUpdated` parameter are accurate and reflect the actual update times.

#### Validation Criteria:

1. **Resource Retrieval:** Verify the client successfully retrieves all resources updated after the specified timestamp in the `_lastUpdated` query.
2. **Cache Consistency:** Inspect the client's cache to confirm that it accurately reflects the updated resources retrieved using the `_lastUpdated` parameter.
3. **No False Positives:** Ensure the client does not retrieve or cache resources that were not updated after the specified timestamp.

**Note:** The specific details of the test implementation, such as the exact resources and timestamps used, will depend on the specific requirements outlined in the FHIR Implementation Guide and the capabilities advertised in the server's Capability Statement. 


---



<a id='server'></a>

## Server

<a id='req-01'></a>

### REQ-01: No PII requirement for directory queries

**Description**: "A conformant Plan-Net service SHALL NOT require a directory mobile application to send consumer identifying information in order to query content."

**Actor**: Server

**Conformance**: SHALL NOT

## Test Specification for REQ-01: No PII for Directory Queries

**1. Requirement ID:** REQ-01

**2. Requirement Analysis:**

   - **Testability Assessment:** Hybrid (Combination of automated API calls and manual inspection of request data)
   - **Complexity:** Simple 
   - **Prerequisites:** 
      - A deployed and running Plan-Net conformant server.
      - Access to server logs or a mechanism to inspect the request payload of the directory query API call.

**3. Test Implementation Strategy:**

   **3.1 Required Inputs and Expected Outputs:**

   | Input                                         | Expected Output                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       

---

<a id='req-03'></a>

### REQ-03: Population of Must Support data elements

**Description**: "Health Plan API actors SHALL be capable of populating all Must Support data elements as part of the query results."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-03: Population of Must Support Data Elements

### 1. Requirement ID

REQ-03

### 2. Requirement Analysis

- **Testability Assessment:** Automatic
- **Complexity:** Moderate
- **Prerequisites:**
    - A running FHIR server that implements the Health Plan API.
    - Access to the server's Capability Statement.
    - A list of all "Must Support" data elements defined in the FHIR Implementation Guide.
    - Test data that includes values for all "Must Support" data elements.

### 3. Test Implementation Strategy

#### 3.1 Required Inputs and Expected Outputs

**Inputs:**

- FHIR Server endpoint URL.
- List of "Must Support" data elements and their corresponding FHIR resource paths.
- Test data for a FHIR resource relevant to the Health Plan API.

**Expected Outputs:**

- HTTP Status Code 200 (OK) for successful retrieval of resources.
- FHIR Resource(s) in the response body.
- All "Must Support" data elements populated with values in the returned resource(s).

#### 3.2 Required FHIR Operations

- **read:** To retrieve resources from the FHIR server.
- **search:** To query for resources based on specific criteria.

**Note:** The specific FHIR operation(s) will depend on the resources and search criteria defined in the Implementation Guide. Ensure the Capability Statement confirms support for these operations on the relevant resources.

#### 3.3 Test Data Requirements

- **Realistic Test Data:** Use realistic and valid test data that conforms to the profiles defined in the Implementation Guide.
- **"Must Support" Data Elements:** Ensure the test data includes values for all "Must Support" data elements.
- **Data Variety:** Include a variety of test data to cover different scenarios and edge cases.

#### 3.4 Validation Criteria

1. **HTTP Status Code:** Verify that the FHIR server returns an HTTP status code of 200 (OK) for successful resource retrieval.
2. **Resource Type:** Validate that the returned resource(s) match the expected type(s) as defined in the Implementation Guide.
3. **"Must Support" Data Element Presence:** For each "Must Support" data element, assert that the corresponding element is present in the returned resource(s).
4. **"Must Support" Data Element Value:** Verify that the value of each "Must Support" data element is not null or empty and conforms to the data type and any constraints defined in the Implementation Guide.

**Test Success Criteria:** The test is considered successful if all the validation criteria are met for all tested resources.

**Test Failure Criteria:** The test fails if any of the validation criteria are not met. The test report should clearly identify the failed criteria and provide details about the failure, including the specific data element and resource involved. 


---

<a id='req-04'></a>

### REQ-04: Not including absent data elements

**Description**: "In situations where information on a particular Must Support data element is not present and the minimum cardinality is 0, the Health Plan API actors SHALL NOT include the data elements in the resource instance returned as part of the query results."

**Actor**: Server

**Conformance**: SHALL NOT

## Test Specification for REQ-04: Not Including Absent Data Elements

### 1. Requirement ID

REQ-04

### 2. Requirement Analysis

- **Testability Assessment**: Automatic
- **Complexity**: Simple
- **Prerequisites**:
    - A running FHIR server that implements the Health Plan API.
    - Capability Statement confirming support for the specific FHIR resources and search parameters used in the test.
    - Test data pre-populated on the server, including resources with intentionally missing "Must Support" data elements where minimum cardinality is 0.

### 3. Test Implementation Strategy

#### 3.1. Required Inputs and Expected Outputs

**Inputs:**

- **FHIR Operation:** A search operation (e.g., GET [base]/[resource type]?...) targeting a resource type and data element relevant to the Health Plan API and specified as "Must Support" with a minimum cardinality of 0 in the Implementation Guide.
- **Test Data:** Resources of the targeted type should exist on the server. Some resources should have the specific "Must Support" data element populated, while others should have it intentionally absent.

**Expected Outputs:**

- **HTTP Status Code:** 200 (OK)
- **FHIR Bundle:** A Bundle resource containing the search results.
- **Resource Instances:** Within the Bundle, resource instances where the targeted data element is absent SHOULD NOT include the element in the response. Resource instances where the element is present SHOULD include it as usual.

#### 3.2. Required FHIR Operations

- **Search (GET):**  GET [base]/[resource type]?...

#### 3.3. Test Data Requirements

- **Resource Type:** Any resource type relevant to the Health Plan API.
- **Data Element:** A "Must Support" data element within the chosen resource type, where the minimum cardinality is 0.
- **Data Instances:**
    - Resources with the targeted data element populated.
    - Resources with the targeted data element intentionally absent.

#### 3.4. Validation Criteria

1. **Response Code Validation:** Assert that the HTTP status code of the response is 200 (OK).
2. **Resource Content Validation:** 
    - For resources where the targeted "Must Support" data element is absent, assert that the element is NOT present in the returned resource instance within the Bundle.
    - For resources where the targeted "Must Support" data element is present, assert that the element IS present and contains the expected value.

**Example Assertion (pseudo-code):**

```
for each resource in response bundle:
  if resource.hasDataElement(targetedElement) and resource.dataElement(targetedElement).value is None:
    assert targetedElement is not a key in resource.data
  else:
    assert targetedElement is a key in resource.data
    assert resource.dataElement(targetedElement).value is not None 
```

**Note:** This test specification focuses on the specific requirement of not including absent data elements. It should be used in conjunction with other tests that validate general FHIR conformance, resource validity, and other requirements outlined in the Implementation Guide. 


---

<a id='req-05'></a>

### REQ-05: Using dataAbsentReason for missing required information

**Description**: "In situations where information on a particular data element is not present and the minimum cardinality is >0, SHALL send the reason for the missing information using values (such as nullFlavors) from the value set where they exist or use the dataAbsentReason extension."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-05: Using dataAbsentReason for Missing Required Information

### 1. Requirement ID

REQ-05

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Moderate
* **Prerequisites:**
    * A running FHIR server that implements the target Implementation Guide.
    * Access to create and update resources relevant to the requirement.
    * Knowledge of resources and data elements with minimum cardinality > 0 within the scope of the Implementation Guide.

### 3. Test Implementation Strategy

#### 3.1 Test Case 1: Valid dataAbsentReason provided

* **Description:** This test case verifies that the server accepts a resource with a required element missing, but a valid `dataAbsentReason` extension provided.

* **Required Inputs:**
    * A FHIR resource relevant to the IG with a required element missing.
    * A valid `dataAbsentReason` extension populated with a code from the appropriate value set (e.g., `http://hl7.org/fhir/ValueSet/data-absent-reason`) or a nullFlavor code if applicable.

* **Expected Outputs:**
    * HTTP Status Code: 200 (OK) or 201 (Created) depending on the FHIR operation.
    * The server should successfully process the resource despite the missing required element.

* **Required FHIR Operations:** 
    * `POST` (for creating a resource) or `PUT` (for updating a resource) to the appropriate resource endpoint.

* **Test Data Requirements:**
    *  A sample resource instance with a missing required element and a valid `dataAbsentReason` extension.

* **Validation Criteria:**
    * Verify the HTTP status code indicates successful processing.
    * Optionally, retrieve the created/updated resource and confirm the `dataAbsentReason` extension is persisted as provided.

#### 3.2 Test Case 2: Missing dataAbsentReason

* **Description:** This test case verifies that the server rejects a resource with a required element missing and no `dataAbsentReason` provided.

* **Required Inputs:**
    * A FHIR resource relevant to the IG with a required element missing and no `dataAbsentReason` extension.

* **Expected Outputs:**
    * HTTP Status Code: 400 (Bad Request) or another appropriate error code indicating the missing required element.
    * An OperationOutcome resource explaining the reason for the rejection, specifically mentioning the missing required element and the need for a `dataAbsentReason`.

* **Required FHIR Operations:**
    * `POST` (for creating a resource) or `PUT` (for updating a resource) to the appropriate resource endpoint.

* **Test Data Requirements:**
    * A sample resource instance with a missing required element and no `dataAbsentReason` extension.

* **Validation Criteria:**
    * Verify the HTTP status code indicates a failed request.
    * Verify the OperationOutcome resource contains the expected error message regarding the missing required element and `dataAbsentReason`.

#### 3.3 Test Case 3: Invalid dataAbsentReason

* **Description:** This test case verifies that the server rejects a resource with a required element missing and an invalid `dataAbsentReason` provided.

* **Required Inputs:**
    * A FHIR resource relevant to the IG with a required element missing.
    * A `dataAbsentReason` extension populated with an invalid code that does not belong to the appropriate value set or a nullFlavor code if not applicable.

* **Expected Outputs:**
    * HTTP Status Code: 400 (Bad Request) or another appropriate error code indicating an invalid data type.
    * An OperationOutcome resource explaining the reason for the rejection, specifically mentioning the invalid `dataAbsentReason` code.

* **Required FHIR Operations:**
    * `POST` (for creating a resource) or `PUT` (for updating a resource) to the appropriate resource endpoint.

* **Test Data Requirements:**
    * A sample resource instance with a missing required element and an invalid `dataAbsentReason` extension.

* **Validation Criteria:**
    * Verify the HTTP status code indicates a failed request.
    * Verify the OperationOutcome resource contains the expected error message regarding the invalid `dataAbsentReason` code. 


---

<a id='req-10'></a>

### REQ-10: JSON format support

**Description**: "Support json source formats for all Plan-Net interactions."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-10: JSON Format Support

### 1. Requirement ID

REQ-10

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Simple
* **Prerequisites:** 
    * A running FHIR server that implements the Plan-Net interactions.
    * Test client capable of sending requests with JSON content type and validating responses.

### 3. Test Implementation Strategy

#### 3.1 Test Cases

| Test Case ID | Test Case Description                                   | Operation | Input (Content-Type) | Expected Output                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           

---

<a id='req-11'></a>

### REQ-11: RESTful behavior implementation

**Description**: "Implement the RESTful behavior according to the FHIR specification."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-11: RESTful Behavior Implementation

### 1. Requirement ID

REQ-11

### 2. Requirement Analysis

**Testability Assessment:**  Hybrid (Combination of automated checks and manual inspection)

**Complexity:** Moderate

**Prerequisites:** 

* A running FHIR server under test.
* Access to the server's Capability Statement.
* Tools for making HTTP requests and inspecting responses (e.g., Postman, curl, REST client).

### 3. Test Implementation Strategy

This requirement is broad and encompasses various aspects of RESTful behavior.  We'll break it down into testable scenarios.

**3.1 HTTP Verb Support and Behavior**

**Description:** Verify the server correctly implements HTTP verbs (GET, POST, PUT, DELETE) according to FHIR specifications.

**Required Inputs:**

* **Resource Type:**  A resource type supported by the server (identified from the Capability Statement).
* **Test Data:** Valid FHIR resources for the chosen resource type.

**Required FHIR Operations:**

* `GET [base]/[resourceType]` (search)
* `POST [base]/[resourceType]` (create)
* `GET [base]/[resourceType]/[id]` (read)
* `PUT [base]/[resourceType]/[id]` (update)
* `DELETE [base]/[resourceType]/[id]` (delete)

**Test Data Requirements:**

* Valid FHIR resources conforming to the chosen resource type's profile.

**Validation Criteria:**

* **HTTP Status Codes:**
    * Successful operations return appropriate 2xx codes (200, 201, 204 as per FHIR spec).
    * Errors result in appropriate 4xx (client error) or 5xx (server error) codes.
* **Response Content-Type:** Responses should have `Content-Type: application/fhir+json` or `application/fhir+xml` based on request headers.
* **Resource Location:**  POST and PUT should return a `Location` header with the URL of the newly created/updated resource.
* **ETag/Last-Modified:**  Resources should include appropriate ETag and/or Last-Modified headers for caching.

**3.2  FHIR RESTful Interactions**

**Description:** Test specific RESTful interactions beyond basic CRUD.

**Required Inputs:**

* **Resource Type:** A resource type supporting the desired interaction (e.g., Patient for `$everything` operation).
* **Search Parameters:**  Valid search parameters defined in the Capability Statement for the chosen resource.

**Required FHIR Operations:**

* `GET [base]/[resourceType]?search-param=value` (search with parameters)
* `GET [base]/Patient/[id]/$everything` (example of a type-specific interaction)

**Test Data Requirements:**

* Existing resources on the server matching potential search criteria.

**Validation Criteria:**

* **Search Results:** Verify correct resources are returned based on search parameters.
* **Operation Outcomes:**  Interactions like `$everything` should return data as specified in the FHIR standard.

**3.3 Error Handling and Status Codes**

**Description:**  Assess how the server handles invalid requests and errors.

**Required Inputs:**

* **Invalid Data:**  Incorrectly formatted FHIR resources, invalid search parameters, etc.

**Required FHIR Operations:**  Any operation can be used with invalid input.

**Test Data Requirements:**

* Intentionally malformed FHIR resources.
* Out-of-bounds values for data types.

**Validation Criteria:**

* **Meaningful Error Codes:** The server returns the correct HTTP status codes (4xx for client errors, 5xx for server errors).
* **FHIR OperationOutcome:**  Error responses include a FHIR OperationOutcome resource providing details about the error.

**Important Notes:**

* This test specification provides a starting point. The specific tests will need to be tailored based on the resources and capabilities declared in the server's Capability Statement.
* Automated testing can cover many aspects (HTTP status codes, response headers). Manual inspection might be needed for more complex behavior verification. 
* Consider negative testing (intentionally providing invalid input) to ensure robust error handling. 


---

<a id='req-12'></a>

### REQ-12: Support for all Implementation Guide profiles

**Description**: "Support all profiles defined in this Implementation Guide."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-12: Support for all Implementation Guide profiles

### 1. Requirement ID

REQ-12

### 2. Requirement Analysis

* **Testability Assessment:** Hybrid (Combination of Automatic and Manual)
* **Complexity:** Moderate
* **Prerequisites:**
    * A deployed FHIR server that implements the target Implementation Guide.
    * Access to the server's CapabilityStatement.
    * A test client capable of making FHIR API calls.
    * A set of test data instances conforming to each profile defined in the Implementation Guide.

### 3. Test Implementation Strategy

This requirement necessitates a two-pronged testing approach:

**A. Automated CapabilityStatement Validation:**

* **Required Inputs:** The server's CapabilityStatement resource.
* **Expected Outputs:** 
    * The CapabilityStatement must declare support (using `profile` element within `rest.resource.profile` or `rest.interaction.profile` depending on the type of profile) for every profile defined in the Implementation Guide.
* **Required FHIR Operations:** `GET /metadata`
* **Test Data Requirements:** N/A
* **Validation Criteria:**
    * **Assert:** The CapabilityStatement's `rest.resource.profile` or `rest.interaction.profile` elements (as appropriate for each profile) contain URLs for all profiles defined in the Implementation Guide.

**B. Manual Data Instance Validation:**

This part involves manual inspection or potentially developing more advanced automated tests depending on tooling availability.

* **Required Inputs:** 
    * For each profile in the Implementation Guide, at least one valid test data instance conforming to that profile.
* **Expected Outputs:**
    * The server should successfully process (create, read, update, delete as applicable based on the profile and its intended use) the provided test data instances without throwing errors related to profile conformance.
* **Required FHIR Operations:** 
    * `POST` (Create) - For each resource profile, attempt to create a new resource instance.
    * `GET` (Read) - Retrieve the created resource instance.
    * `PUT` or `PATCH` (Update) - Modify and update the resource instance.
    * `DELETE` - Delete the resource instance.
    * The specific operations to test will depend on the type of profile and the interactions it's designed for.
* **Test Data Requirements:**
    * A set of valid test data instances representing different clinical scenarios and edge cases, conforming to each profile in the Implementation Guide.
* **Validation Criteria:**
    * **Verify:** The server accepts and processes the test data instances without returning errors specifically related to profile validation. This may involve inspecting HTTP status codes (e.g., 200 OK, 201 Created) and OperationOutcome resources for errors.
    * **Manual Inspection:**  Depending on the complexity of the profiles and the capabilities of the testing tools, manual inspection of the processed data may be necessary to confirm full conformance to the Implementation Guide's requirements.

**Note:** The manual validation steps might be automatable with more sophisticated tooling that can validate FHIR resources against profiles and Implementation Guide requirements. 


---

<a id='req-13'></a>

### REQ-13: Unauthorized request response

**Description**: "Return the following response classes: (Status 401/4xx): unauthorized request."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-13: Unauthorized Request Response

**1. Requirement ID:** REQ-13

**2. Requirement Analysis:**

   - **Testability Assessment:** Automatic
   - **Complexity:** Simple
   - **Prerequisites:**
     - A running FHIR server that implements the relevant resources and operations.
     - A test client capable of making authenticated and unauthenticated requests to the FHIR server.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Unauthorized Access to Protected Resource**

     - **Description:** Verify that the server returns a 401 Unauthorized response when an unauthenticated request is made to a protected resource.
     - **Required Inputs:**
       - **Request Type:** GET, POST, PUT, DELETE (depending on the resource and operation being tested)
       - **Resource URL:** URL of a protected resource on the FHIR server
       - **Authentication:** None (request should be sent without any authentication headers)
     - **Expected Outputs:**
       - **HTTP Status Code:** 401 Unauthorized
       - **FHIR OperationOutcome Resource:** (Optional) The server MAY return an OperationOutcome resource with details about the authorization error.
     - **Required FHIR Operations:** Any read, create, update, or delete operation on a protected resource as defined in the Capability Statement.
     - **Test Data Requirements:**  N/A (test can be performed with any valid resource URL)
     - **Validation Criteria:**
       - Verify that the HTTP status code of the response is 401 Unauthorized.
       - (Optional) If an OperationOutcome resource is returned, verify that it contains relevant error codes and messages related to unauthorized access.

   **3.2. Test Case 2:  Unauthorized Access with Invalid Credentials**

     - **Description:** Verify that the server returns a 401 Unauthorized response when a request is made with invalid credentials.
     - **Required Inputs:**
       - **Request Type:** GET, POST, PUT, DELETE (depending on the resource and operation being tested)
       - **Resource URL:** URL of a protected resource on the FHIR server
       - **Authentication:** Invalid credentials (e.g., incorrect username/password, expired token)
     - **Expected Outputs:**
       - **HTTP Status Code:** 401 Unauthorized
       - **FHIR OperationOutcome Resource:** (Optional) The server MAY return an OperationOutcome resource with details about the authorization error.
     - **Required FHIR Operations:** Any read, create, update, or delete operation on a protected resource as defined in the Capability Statement.
     - **Test Data Requirements:** N/A (test can be performed with any valid resource URL)
     - **Validation Criteria:**
       - Verify that the HTTP status code of the response is 401 Unauthorized.
       - (Optional) If an OperationOutcome resource is returned, verify that it contains relevant error codes and messages related to invalid credentials.

**Note:** 

* These test cases assume that the Capability Statement indicates the server requires authentication for the chosen resources and operations. 
* The specific error codes and messages in the OperationOutcome resource may vary depending on the server's implementation. 
* Additional test cases may be needed to cover different authentication mechanisms and scenarios. 


---

<a id='req-14'></a>

### REQ-14: Insufficient scope response

**Description**: "Return the following response classes: (Status 403): insufficient scope."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-14: Insufficient Scope Response

### 1. Requirement ID

REQ-14

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Simple
* **Prerequisites:**
    * A running FHIR server that implements the relevant resources and operations.
    * A test client capable of making authenticated FHIR API requests.
    * A valid access token with insufficient scope to perform the tested operation. 

### 3. Test Implementation Strategy

#### 3.1 Test Case 1: Trigger Insufficient Scope Response

**Objective:** Verify that the server returns a 403 Forbidden response with the "insufficient scope" response code when a request is made with an access token lacking the necessary scope.

**Inputs:**

* **FHIR Operation:**  A FHIR operation requiring specific scopes (e.g., `read`, `write`, `*`). The specific operation chosen should be one supported by the server as per the Capability Statement.
* **Resource:** A FHIR resource relevant to the chosen operation.
* **Authorization Header:**  A valid access token with insufficient scope for the chosen operation.

**Expected Outputs:**

* **HTTP Status Code:** 403 Forbidden
* **FHIR OperationOutcome:**
    * **ResourceType:** OperationOutcome
    * **Issue:**
        * **Severity:** Error
        * **Code:** Security
        * **Details:**
            * **Text:** insufficient scope

**Validation Criteria:**

* **Assert:** The HTTP status code is 403 Forbidden.
* **Assert:** The response body is a valid FHIR OperationOutcome resource.
* **Assert:** The OperationOutcome resource contains an issue with severity "error", code "security", and details text "insufficient scope".

#### 3.2 Test Data Requirements

* **Access Token:**  A valid access token with known scopes that do NOT match the required scopes of the chosen FHIR operation.

#### 3.3  Additional Notes

* This test case should be repeated for different FHIR operations requiring specific scopes to ensure comprehensive coverage.
* Refer to the provided Capability Statement to identify the specific scopes required for each operation and to confirm the server's support for the chosen operations. 
* Consider using a tool like [Firely .NET](https://fire.ly/) or [HAPI FHIR](http://hapifhir.io/) to simplify the creation and validation of FHIR resources and interactions. 


---

<a id='req-15'></a>

### REQ-15: Invalid parameter response

**Description**: "Return the following response classes: (Status 400): invalid parameter."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-15: Invalid Parameter Response

**1. Requirement ID:** REQ-15

**2. Requirement Analysis:**

   - **Testability Assessment:** Automatic
   - **Complexity:** Simple
   - **Prerequisites:**
     - A running FHIR server that implements the relevant resources and operations.
     - The Capability Statement of the server should indicate support for the specific FHIR resource and operation being tested.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Invalid Parameter Value**

     - **Description:** Send a request with an invalid value for a required parameter.
     - **Required Inputs:**
       - **FHIR Operation:**  (Specify the relevant operation from the Capability Statement, e.g., `GET /Patient/{id}`)
       - **Parameter:** (Specify the parameter to be tested)
       - **Invalid Value:** (Provide a value that violates the parameter's definition in the FHIR specification)
     - **Expected Outputs:**
       - **HTTP Status Code:** 400 (Bad Request)
       - **FHIR OperationOutcome Resource:**
         - `issue.severity`:  "error" 
         - `issue.code`: "invalid"
         - `issue.diagnostics`: A human-readable explanation of the error, indicating the specific invalid parameter.
     - **Validation Criteria:**
       - Verify the HTTP status code is 400.
       - Verify the response body contains a valid FHIR OperationOutcome resource.
       - Verify the OperationOutcome resource contains an issue with the expected severity, code, and a descriptive diagnostic message.

   **3.2. Test Case 2: Missing Required Parameter**

     - **Description:** Send a request missing a parameter marked as required.
     - **Required Inputs:**
       - **FHIR Operation:** (Specify the relevant operation from the Capability Statement)
       - **Parameter:** (Specify the required parameter to be omitted)
     - **Expected Outputs:**
       - **HTTP Status Code:** 400 (Bad Request)
       - **FHIR OperationOutcome Resource:**
         - `issue.severity`: "error" 
         - `issue.code`: "required" 
         - `issue.diagnostics`: A human-readable explanation of the error, indicating the missing required parameter. 
     - **Validation Criteria:**
       - Verify the HTTP status code is 400.
       - Verify the response body contains a valid FHIR OperationOutcome resource.
       - Verify the OperationOutcome resource contains an issue with the expected severity, code, and a descriptive diagnostic message.

**4. Test Data Requirements:**

   - The specific test data will depend on the resource and operation being tested. 
   - Use realistic but de-identified data. 
   - Ensure the data conforms to the FHIR data types and profiles defined in the specification. 

**Notes:**

- This test specification provides a general framework. You'll need to adapt it based on the specific resource and operation you are testing and the details provided in the Capability Statement.
- Consider adding more test cases to cover different types of invalid parameters (e.g., incorrect data type, out-of-range values). 
- Automated testing tools can be used to execute these tests efficiently and repeatedly. 


---

<a id='req-16'></a>

### REQ-16: Unknown resource response

**Description**: "Return the following response classes: (Status 404): unknown resource."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-16: Unknown Resource Response

**1. Requirement ID:** REQ-16

**2. Requirement Analysis:**

   - **Testability Assessment:** Automatic
   - **Complexity:** Simple
   - **Prerequisites:** 
      - A running FHIR server that implements the target Implementation Guide.
      - The Capability Statement of the FHIR server should be accessible.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Request for an Unknown Resource**

     - **Description:** This test case verifies that the server returns a Status 404 (Not Found) response when a request is made for a resource type that is not supported.

     - **Required Inputs:**
       - **FHIR Server Base URL:** The base URL of the FHIR server under test.
       - **Unknown Resource Type:** A string representing a resource type not defined in the FHIR specification and not supported by the server (e.g., "InvalidResource").

     - **Expected Outputs:**
       - **HTTP Status Code:** 404 (Not Found)
       - **Response Body:** An OperationOutcome resource with an issue of severity "error" and a diagnostic message indicating that the requested resource type is not known.

     - **Required FHIR Operations:**
       - HTTP GET request to `<FHIR Server Base URL>/<Unknown Resource Type>`

     - **Test Data Requirements:**  N/A (No specific test data is required beyond the unknown resource type).

     - **Validation Criteria:**
       - **Assert:** The HTTP response status code is 404 (Not Found).
       - **Assert:** The response body is a valid OperationOutcome resource.
       - **Assert:** The OperationOutcome resource contains an issue with:
           - severity = "error"
           - A diagnostic message indicating the resource type is not known.

   **3.2. Test Case 2: Request for an Unsupported but Known Resource**

     - **Description:** This test case verifies that the server returns a Status 404 (Not Found) response when a request is made for a resource type that is defined in the FHIR specification but not supported by the server as per its CapabilityStatement.

     - **Required Inputs:**
       - **FHIR Server Base URL:** The base URL of the FHIR server under test.
       - **Unsupported Resource Type:** A string representing a valid FHIR resource type that is not listed as supported in the server's CapabilityStatement (e.g., "MedicationDispense" if not supported).

     - **Expected Outputs:**
       - **HTTP Status Code:** 404 (Not Found)
       - **Response Body:** An OperationOutcome resource with an issue of severity "error" and a diagnostic message indicating that the requested resource type is not supported.

     - **Required FHIR Operations:**
       - HTTP GET request to `<FHIR Server Base URL>/<Unsupported Resource Type>`

     - **Test Data Requirements:**  N/A (No specific test data is required beyond the unsupported resource type).

     - **Validation Criteria:**
       - **Assert:** The HTTP response status code is 404 (Not Found).
       - **Assert:** The response body is a valid OperationOutcome resource.
       - **Assert:** The OperationOutcome resource contains an issue with:
           - severity = "error"
           - A diagnostic message indicating the resource type is not supported. 

**Note:** These test cases can be automated using testing frameworks like Jest (JavaScript), pytest (Python), or Rest-Assured (Java) to send requests and validate the responses programmatically. 


---

<a id='req-17'></a>

### REQ-17: Deleted resource response

**Description**: "Return the following response classes: (Status 410): deleted resource."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-17: Deleted Resource Response

### 1. Requirement ID

REQ-17

### 2. Requirement Analysis

**Testability Assessment:** Automatic

**Complexity:** Simple

**Prerequisites:**

* A FHIR server instance under test.
* A pre-existing resource on the server that can be deleted.
* The server's Capability Statement indicating support for the `delete` operation on the chosen resource type.

### 3. Test Implementation Strategy

**Required Inputs:**

* **Resource Type:** The type of resource to be deleted (e.g., Patient, Observation).
* **Resource ID:** The logical ID of the resource to be deleted.

**Expected Outputs:**

* **HTTP Status Code:** 410 (Gone)
* **Response Body:**  Optionally, the response body MAY include an OperationOutcome resource providing further context.

**Required FHIR Operations:**

1. **READ:** Retrieve the resource to be deleted to confirm its existence and obtain its latest version ID (for optimistic locking).
2. **DELETE:** Delete the resource using the appropriate endpoint and resource ID.

**Test Data Requirements:**

* A valid resource of the chosen type should be created on the server before executing the test.

**Validation Criteria:**

1. **Status Code Assertion:** Verify that the HTTP status code returned from the DELETE request is 410 (Gone).
2. **Resource Retrieval Assertion:** Attempt to retrieve the deleted resource using a READ request. This request should also return a 410 (Gone) status code, confirming the resource is no longer available. 

**Example Test Case (using pseudo-code):**

```
// 1. Retrieve the resource to be deleted
response = fhirClient.read(ResourceType, ResourceId);
assert response.statusCode == 200; // Ensure resource exists

// 2. Delete the resource
deleteResponse = fhirClient.delete(ResourceType, ResourceId);
assert deleteResponse.statusCode == 410; // Verify deletion response

// 3. Attempt to retrieve the deleted resource
retrieveResponse = fhirClient.read(ResourceType, ResourceId);
assert retrieveResponse.statusCode == 410; // Confirm resource is gone
```

**Note:** This test specification assumes that the Capability Statement confirms the server's support for the `delete` operation on the chosen resource type. The specific details of the FHIR client implementation and assertion library are left to the testing framework being used. 


---

<a id='req-18'></a>

### REQ-18: Profile identification in meta attribute

**Description**: "Identify the Plan-Net profiles supported as part of the FHIR meta.profile attribute for each instance."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-18: Profile Identification in Meta Attribute

### 1. Requirement ID

REQ-18

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Simple
* **Prerequisites:** 
    * A running FHIR server that implements the Implementation Guide.
    * Access to the server's Capability Statement.
    * Ability to make FHIR API calls to the server.

### 3. Test Implementation Strategy

#### 3.1 Required Inputs and Expected Outputs

| Input | Expected Output |
|---|---|
| FHIR Resource Instance (e.g., Plan) | HTTP Response containing the resource instance with the `meta.profile` element populated with the correct Plan-Net profile URL. |

#### 3.2 Required FHIR Operations

* **READ Operation:** Retrieve a Plan resource instance from the server. The specific endpoint will depend on the resource type being tested. For example:
    * `GET [base]/Plan/[id]`

#### 3.3 Test Data Requirements

* **Test Data:** Any valid Plan resource instance conforming to the Plan-Net profile.

#### 3.4 Validation Criteria

1. **HTTP Status Code:** Verify that the READ operation returns an HTTP status code of 200 (OK).
2. **Resource Type:** Verify that the returned resource is of the correct type (e.g., Plan).
3. **Meta.profile:** Verify that the `meta.profile` element in the returned resource:
    * **Exists:** The element should be present within the resource's metadata.
    * **Content:** The element should contain the correct Plan-Net profile URL as defined in the Implementation Guide. 
    * **Multiple Profiles:** If the resource conforms to multiple profiles, ensure all relevant Plan-Net profile URLs are listed.

**Example Assertion (pseudo-code):**

```
response.status.should.equal(200);
response.body.resourceType.should.equal('Plan');
response.body.meta.profile.should.contain('http://example.org/fhir/Plan-Net/StructureDefinition/plan-net-profile'); // Replace with actual profile URL
```

**Note:** This test specification focuses on the "Plan" resource as an example. The same principles apply to other resource types defined in the Plan-Net profile. The test data and validation criteria should be adapted accordingly. 


---

<a id='req-19'></a>

### REQ-19: Individual search parameter support

**Description**: "Support the searchParameters on each profile individually."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-19: Individual Search Parameter Support

### 1. Requirement ID

REQ-19

### 2. Requirement Analysis

**Testability Assessment:** Automatic

**Complexity:** Moderate

**Prerequisites:**

* A running FHIR server that implements the target Implementation Guide.
* Access to the server's Capability Statement.
* Test data consisting of FHIR resources conforming to the profiles defined in the Implementation Guide.

### 3. Test Implementation Strategy

#### 3.1 Required Inputs and Expected Outputs

**Inputs:**

* FHIR Server base URL
* List of profiles defined in the Implementation Guide
* For each profile:
    * List of search parameters defined in the profile

**Expected Outputs:**

* For each profile and each search parameter combination:
    * HTTP Status Code 200 (OK) for successful search
    * Bundle resource containing matching resources (can be empty if no match)

#### 3.2 Required FHIR Operations

* **read** operation on the `CapabilityStatement` resource to retrieve supported search parameters.
* **search** operation on each resource type with the defined search parameters.

#### 3.3 Test Data Requirements

* **Capability Statement:**  The server's Capability Statement is required to verify that the search operations and parameters are advertised as supported.
* **Test Resources:**  A set of FHIR resources conforming to the profiles defined in the Implementation Guide. These resources should be populated with diverse data to allow testing various search parameters and combinations.

#### 3.4 Validation Criteria

1. **Capability Statement Validation:**
    * Verify that the Capability Statement advertises support for the `search` operation on the relevant resource types.
    * For each profile, verify that the Capability Statement lists all search parameters defined in the profile as supported search parameters for the corresponding resource type.

2. **Search Operation Validation:**
    * For each profile and each defined search parameter:
        * Construct a valid search URL using the parameter and appropriate test data.
        * Execute the search request against the FHIR server.
        * **Assert:** The server returns an HTTP status code 200 (OK).
        * **Assert:** The response body contains a valid Bundle resource.
        * **Assert:** The Bundle resource contains only resources that match the search criteria based on the tested parameter.

3. **Error Handling:**
    * **Assert:** The server returns appropriate error codes (e.g., 400 Bad Request) for invalid search parameter names or values.

**Note:** This test specification focuses on validating individual search parameter support.  Additional tests might be needed to cover combinations of search parameters, parameter modifiers, and specific edge cases defined in the Implementation Guide. 


---

<a id='req-20'></a>

### REQ-20: Combination search parameter support

**Description**: "Support the searchParameters on each profile in combination."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-20: Combination Search Parameter Support

### 1. Requirement ID

REQ-20

### 2. Requirement Analysis

* **Testability Assessment:** Automatic 
* **Complexity:** Moderate
* **Prerequisites:**
    * A running FHIR server that conforms to the implementation guide.
    * The CapabilityStatement of the FHIR server should advertise support for the search parameters mentioned in the requirement.
    * Test data pre-populated on the server, representing resources with various combinations of search parameter values.

### 3. Test Implementation Strategy

#### 3.1. Required Inputs and Expected Outputs

| Input                                       | Expected Output                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            

---

<a id='req-21'></a>

### REQ-21: Forward chaining support

**Description**: "Support forward chaining on all search parameters that specify the 'chain' property."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-21: Forward Chaining Support

### 1. Requirement ID

REQ-21

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Moderate
* **Prerequisites:**
    * A FHIR server instance with the implemented Implementation Guide.
    * Access to the server's Capability Statement.
    * A list of search parameters that specify the 'chain' property within the IG.
    * Test data that can be used to exercise forward chaining on the identified search parameters.

### 3. Test Implementation Strategy

#### 3.1. Test Procedure:

1. **Retrieve Capability Statement:** 
    * Send a GET request to the server's base URL + `/metadata`.
    * Verify the response status code is 200 OK and the Content-Type is application/fhir+json.
2. **Identify Search Parameters with 'chain' Property:**
    * Parse the Capability Statement and iterate through the resources and their search parameters.
    * Create a list of search parameters that have the 'chain' property defined.
3. **Execute Forward Chaining Tests:**
    * For each identified search parameter with the 'chain' property:
        * **Prepare Test Data:** Create or identify existing resources that establish a chain based on the target search parameter. This might involve creating multiple resources with references linking them together.
        * **Send Search Request:** Construct a search request using the identified search parameter and a value that would trigger forward chaining. 
        * **Validate Response:**
            * Verify the response status code is 200 OK.
            * Verify the Content-Type is application/fhir+json.
            * Verify the response Bundle contains the expected resources that are part of the forward chain, not just the resources directly matching the search parameter. 

#### 3.2. Required FHIR Operations:

* **GET** `/metadata` - To retrieve the server's Capability Statement.
* **GET** `/{resourceType}?{searchParameter}={value}` - To execute searches with different search parameters supporting forward chaining.

#### 3.3. Test Data Requirements:

* **Resource instances:**  The specific resource types will depend on the search parameters being tested. The resources should be created with relationships (e.g., references) that align with the definition of the 'chain' property for the specific search parameter.

#### 3.4. Validation Criteria:

* **Capability Statement Retrieval:** Successful retrieval of the Capability Statement with a 200 OK status code.
* **Search Parameter Identification:** Successful identification of all search parameters with the 'chain' property within the Capability Statement.
* **Forward Chaining Functionality:** For each search parameter with 'chain' property:
    * **Successful Response:** The server should return a 200 OK status code for the search request.
    * **Complete Chain Retrieval:** The response Bundle should include all resources that are part of the forward chain, not just the resources directly matching the search parameter value.

#### 3.5. Example:

Let's assume the Capability Statement indicates that the `Patient` resource's `link` search parameter supports forward chaining.

* **Test Data:** Create three Patient resources:
    * Patient A: id=patientA
    * Patient B: id=patientB, link=Patient/patientA
    * Patient C: id=patientC, link=Patient/patientB
* **Search Request:** `GET /Patient?link=patientA`
* **Expected Response:** A Bundle containing Patient resources A, B, and C, demonstrating that the server correctly traversed the 'link' chain. 


---

<a id='req-22'></a>

### REQ-22: Reverse chaining support

**Description**: "Support reverse chaining on all search parameters that specify the 'chain' property."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-22: Reverse Chaining Support

### 1. Requirement ID

REQ-22

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Moderate
* **Prerequisites:** 
    * The FHIR server under test must have resources loaded that allow for chaining on search parameters.
    * The Capability Statement of the FHIR server must declare support for the search parameters that will be used for testing reverse chaining. 
    * The Capability Statement should indicate which search parameters support the "chain" property.

### 3. Test Implementation Strategy

#### 3.1. Test Procedure

1. **Identify Resources and Search Parameters:** From the Capability Statement, identify resources and their corresponding search parameters that declare support for the "chain" property.
2. **Generate Test Data:** Create or identify existing resources in the FHIR server that establish a chain based on the identified search parameters. For example, if "Patient.general-practitioner" supports chaining, ensure there are Patient and Practitioner resources with the reference link established.
3. **Construct Reverse Chained Search Request:** Build a search request that utilizes the identified search parameter with reverse chaining. For example:
    * `GET [base]/Patient?general-practitioner:chain=name=test` (This searches for Patients whose general practitioner has a name of "test")
4. **Execute Search Request:** Send the constructed search request to the FHIR server. 
5. **Analyze Search Response:** Examine the response bundle returned by the server.

#### 3.2. Required FHIR Operations

* `READ`: To retrieve the Capability Statement and identify resources and search parameters supporting reverse chaining.
* `SEARCH`: To execute the reverse chained search requests.

#### 3.3. Test Data Requirements

* **Resources:**  A set of resources that establish a chain based on the search parameters supporting the "chain" property. The specific resources will depend on the identified search parameters.
* **Capability Statement:** The server's Capability Statement is crucial for identifying the resources and search parameters that support reverse chaining.

#### 3.4. Validation Criteria

* **HTTP Status Code:** The server MUST return an HTTP status code of 200 (OK) if the reverse chained search is successful.
* **Response Bundle:** The response bundle SHOULD contain only the resources that match the reverse chained search criteria.
* **Error Handling:** If the server encounters an error processing the reverse chained search, it SHOULD return an appropriate OperationOutcome resource with details about the error. 

**Example Test Case:**

| Test Case ID | Test Case Description |
|---|---|
| TC_REV_CHAIN_001 | Verify reverse chaining on Patient.general-practitioner |

**Steps:**

1. Retrieve the Capability Statement and confirm that the `Patient.general-practitioner` search parameter supports the "chain" property.
2. Create (or identify existing) a Patient resource with a reference to a Practitioner resource in the `general-practitioner` field.
3. Construct a search request: `GET [base]/Patient?general-practitioner:chain=name=test` (assuming the linked Practitioner has a name of "test").
4. Execute the search request.
5. **Expected Result:** The server returns an HTTP status code of 200 (OK) and a Bundle containing only the Patient resource linked to the Practitioner with the specified name.

This test specification provides a framework for testing reverse chaining support. You can adapt it to test other search parameters that support the "chain" property based on the specific Capability Statement of the FHIR server under test. 


---

<a id='req-23'></a>

### REQ-23: XML format support

**Description**: "Support xml source formats for all Plan-Net interactions."

**Actor**: Server

**Conformance**: SHOULD

## Test Specification for REQ-23: XML Format Support

**1. Requirement ID:** REQ-23

**2. Requirement Analysis:**

   - **Testability Assessment:** Automatic
   - **Complexity:** Simple
   - **Prerequisites:** 
      - A running FHIR server that implements the Plan-Net IG.
      - Test client capable of sending requests with XML payloads and verifying XML responses.
      - Test Plan-Net resources in XML format.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Create Plan-Net Resource (XML)**

      - **Description:** Verify the server can successfully process and persist a new Plan-Net resource submitted in XML format.

      - **Required Inputs:**
         - A valid Plan-Net resource instance in XML format.
         - The endpoint URL for the relevant Plan-Net resource type.

      - **Required FHIR Operations:** 
         - `POST [base]/[resourceType]` (e.g., `POST [base]/PlanDefinition`)

      - **Test Data Requirements:** 
         - A valid XML instance of a Plan-Net resource (e.g., PlanDefinition, Coverage, etc.).

      - **Expected Outputs:**
         - HTTP Status Code: `201 Created`
         - A valid `Location` header indicating the URL of the newly created resource.
         - Optionally, the server may return the complete newly created resource in the response body (in XML format).

      - **Validation Criteria:**
         - Verify the HTTP status code.
         - Verify the `Location` header is present and contains a valid URL.
         - Optionally, verify the returned resource in the response body matches the submitted resource data.

   **3.2. Test Case 2: Read Plan-Net Resource (XML)**

      - **Description:** Verify the server can return a Plan-Net resource in XML format when requested.

      - **Required Inputs:**
         - The URL of an existing Plan-Net resource.
         - HTTP Header: `Accept: application/xml`

      - **Required FHIR Operations:** 
         - `GET [resource URL]`

      - **Test Data Requirements:** 
         - An existing Plan-Net resource on the server.

      - **Expected Outputs:**
         - HTTP Status Code: `200 OK`
         - The requested Plan-Net resource in XML format.

      - **Validation Criteria:**
         - Verify the HTTP status code.
         - Verify the response Content-Type header is `application/xml`.
         - Verify the response body contains a valid XML representation of the requested resource.

   **3.3. Test Case 3: Update Plan-Net Resource (XML)**

      - **Description:** Verify the server can correctly process updates to a Plan-Net resource when submitted in XML format.

      - **Required Inputs:**
         - The URL of an existing Plan-Net resource.
         - A modified version of the Plan-Net resource in XML format.

      - **Required FHIR Operations:** 
         - `PUT [resource URL]`

      - **Test Data Requirements:** 
         - An existing Plan-Net resource on the server.
         - A modified version of that resource in XML format.

      - **Expected Outputs:**
         - HTTP Status Code: `200 OK` or `204 No Content`
         - Optionally, the server may return the complete updated resource in the response body (in XML format).

      - **Validation Criteria:**
         - Verify the HTTP status code.
         - Optionally, verify the returned resource in the response body reflects the submitted changes.
         - Retrieve the resource using a `GET` request and verify the data is updated as expected.

   **Note:** These test cases should be repeated for all relevant Plan-Net resource types and different interaction scenarios (search, delete, etc.) to ensure comprehensive coverage of the requirement. 


---

<a id='req-24'></a>

### REQ-24: Rejection of unauthorized requests

**Description**: "A server SHALL reject any unauthorized requests by returning an HTTP 401 unauthorized response code."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-24: Rejection of Unauthorized Requests

**1. Requirement ID:** REQ-24

**2. Requirement Analysis:**

   - **Testability Assessment:** Automatic
   - **Complexity:** Simple
   - **Prerequisites:**
     - A FHIR server running and accessible.
     - A test client capable of sending HTTP requests with and without authorization headers.
     - Knowledge of a protected resource endpoint on the FHIR server.

**3. Test Implementation Strategy:**

   **3.1. Test Case 1: Request without Authorization Header**

     - **Test Objective:** Verify the server rejects requests without an Authorization header with an HTTP 401 Unauthorized response.

     - **Required Inputs:**
       - **HTTP Method:** GET, POST, PUT, DELETE (any operation on a protected resource)
       - **URL:** A protected resource endpoint on the FHIR server.
       - **Headers:** No Authorization header.

     - **Expected Outputs:**
       - **HTTP Status Code:** 401 Unauthorized
       - **Response Body:**  May contain server-specific error details or conform to FHIR OperationOutcome resource format for error reporting.

     - **Required FHIR Operations:** Any operation on a protected resource (read, create, update, delete).
     - **Test Data Requirements:**  N/A (No specific data is required in the request)
     - **Validation Criteria:**
       - Assert that the HTTP status code of the response is 401 (Unauthorized).

   **3.2. Test Case 2: Request with Invalid Authorization Header**

     - **Test Objective:** Verify the server rejects requests with an invalid Authorization header with an HTTP 401 Unauthorized response.

     - **Required Inputs:**
       - **HTTP Method:** GET, POST, PUT, DELETE (any operation on a protected resource)
       - **URL:** A protected resource endpoint on the FHIR server.
       - **Headers:** Authorization header with an invalid token (e.g., expired, incorrect format, revoked).

     - **Expected Outputs:**
       - **HTTP Status Code:** 401 Unauthorized
       - **Response Body:**  May contain server-specific error details or conform to FHIR OperationOutcome resource format for error reporting.

     - **Required FHIR Operations:** Any operation on a protected resource.
     - **Test Data Requirements:** N/A (No specific data is required in the request)
     - **Validation Criteria:**
       - Assert that the HTTP status code of the response is 401 (Unauthorized).

**Note:** 

* These test cases are designed to be automated. Testing tools like Postman, Insomnia, or custom scripts can be used to execute these tests.
* The specific format and content of the Authorization header will depend on the authentication mechanism implemented by the FHIR server (e.g., OAuth2, Basic Authentication).
* The Capability Statement should be consulted to determine which resources are considered protected and require authorization. 


---

<a id='req-25'></a>

### REQ-25: Support for read interaction

**Description**: "For each resource type and profile, a Plan Net server SHALL support the read interaction."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-25: Support for Read Interaction

**1. Requirement ID:** REQ-25

**2. Requirement Analysis:**

   - **Testability Assessment:** Automatic
   - **Complexity:** Simple
   - **Prerequisites:** 
      - A running FHIR server that implements the Plan Net Implementation Guide.
      - The server's Capability Statement is accessible.
      - At least one resource instance of each supported resource type and profile exists on the server.

**3. Test Implementation Strategy:**

   **3.1. Required Inputs:**

     - **Capability Statement URL:** The URL to access the server's Capability Statement.
     - **Resource Type:** The specific resource type to test (e.g., "Patient", "Observation"). This can be parameterized to iterate through all supported resource types.
     - **Resource ID:** A valid ID of an existing resource of the specified type.

   **3.2. Expected Outputs:**

     - **HTTP Status Code:** 200 (OK)
     - **Response Body:** A FHIR resource of the specified type and ID, conforming to the expected profile (if applicable).

   **3.3. Required FHIR Operations:**

     - `GET [base]/[resourceType]/[id]` 
       - This operation is expected to be supported based on the requirement "a Plan Net server SHALL support the read interaction."

   **3.4. Test Data Requirements:**

     - The test will require pre-existing data on the server. 
     - The specific data content is not important, but it should be valid FHIR and conform to any specified profiles.

   **3.5. Validation Criteria:**

     1. **Validate Capability Statement:**
        - Verify that the Capability Statement advertises support for the `read` interaction for the given resource type and profile.
     2. **Perform Read Operation:**
        - Send a `GET` request to the appropriate endpoint for the resource type and ID.
     3. **Validate HTTP Status Code:**
        - Assert that the response status code is `200 (OK)`.
     4. **Validate Response Content:**
        - Assert that the response body is a valid FHIR resource.
        - Assert that the resource type in the response matches the requested resource type.
        - Assert that the resource ID in the response matches the requested resource ID.
        - If applicable, validate that the returned resource conforms to the expected profile using a schema validator.

**Note:** This test specification can be automated using testing frameworks like Jest, Mocha, or pytest along with FHIR client libraries. The test can be parameterized to iterate through all supported resource types and profiles advertised in the Capability Statement. 


---

<a id='req-26'></a>

### REQ-26: Support for vread interaction

**Description**: "For each resource type and profile, a Plan Net server SHOULD support the vread interaction."

**Actor**: Server

**Conformance**: SHOULD

## Test Specification for REQ-26: Support for vread interaction

### 1. Requirement ID

REQ-26

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Simple
* **Prerequisites:**
    * A running FHIR server under test that implements the Plan Net profile.
    * At least one resource instance of each supported resource type exists on the server.
    * The server's Capability Statement is accessible.

### 3. Test Implementation Strategy

#### 3.1. Test Procedure

1. **Retrieve Capability Statement:**
    * Send a GET request to the server's base URL + `/metadata`.
    * Verify the response status code is 200 OK.
    * Parse the Capability Statement resource from the response body.

2. **Identify Supported Resources:**
    * Iterate through the `rest.resource` array in the Capability Statement.
    * For each resource, check if the `interaction` array contains an entry with `code` equal to "vread".
    * If "vread" is present, add the resource type to a list of supported resources.

3. **Perform vread Interaction for Each Supported Resource:**
    * For each resource type in the list of supported resources:
        * Retrieve a previously stored resource instance ID for the resource type.
        * Send a GET request to the server's base URL + `/&lt;resourceType&gt;/&lt;resourceId&gt;/_history/&lt;versionId&gt;`.
        * Verify the response status code is 200 OK.
        * Verify the response body contains the requested version of the resource.

#### 3.2. Required FHIR Operations

* **GET /metadata:** To retrieve the server's Capability Statement.
* **GET /&lt;resourceType&gt;/&lt;resourceId&gt;/_history/&lt;versionId&gt;:** To perform the vread interaction for each supported resource type.

#### 3.3. Test Data Requirements

* A list of resource types supported by the server, obtained from the Capability Statement.
* For each supported resource type, a pre-existing resource instance ID and a valid version ID.

#### 3.4. Validation Criteria

* **Capability Statement:** The Capability Statement MUST be successfully retrieved with a 200 OK status code.
* **vread Interaction:** For each supported resource type, the vread interaction MUST return a 200 OK status code and the requested version of the resource in the response body.

#### 3.5. Test Outcome

The test is considered successful if all validation criteria are met. If any validation criterion fails, the test fails, and the specific failure point should be reported. 


---

<a id='req-27'></a>

### REQ-27: Support for _includes

**Description**: "[For each resource] A Server SHALL be capable of supporting the following _includes [list]."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-27: Support for _includes

### 1. Requirement ID

REQ-27

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Simple 
* **Prerequisites:**
    * A running FHIR server that conforms to the implementation guide.
    * A list of supported _includes from the implementation guide's Capability Statement.
    * Test client capable of making FHIR API requests.

### 3. Test Implementation Strategy

#### 3.1 Required Inputs and Expected Outputs

| Input                                       | Expected Output                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             

---

<a id='req-28'></a>

### REQ-28: Support for _revincludes

**Description**: "[For each resource] A Server SHALL be capable of supporting the following _revincludes: [list]."

**Actor**: Server

**Conformance**: SHALL

## Test Specification for REQ-28: Support for _revincludes

**1. Requirement ID:** REQ-28

**2. Requirement Analysis:**

   - **Testability Assessment:** Automatic
   - **Complexity:** Simple
   - **Prerequisites:** 
     - A running FHIR server that implements the target Implementation Guide.
     - Access to the server's Capability Statement.
     - A test client capable of making FHIR API requests.

**3. Test Implementation Strategy:**

   **3.1. Required Inputs:**

     - **Capability Statement URL:** The URL to access the server's Capability Statement.
     - **List of Supported _revincludes:** The list of _revincludes specified in REQ-28's "Description" section.

   **3.2. Expected Outputs:**

     - **HTTP Status Code:** 200 OK for successful retrieval of resources with the specified _revincludes.
     - **FHIR Bundle:** A valid FHIR Bundle containing the requested resources and their related resources as specified by the _revincludes.

   **3.3. Required FHIR Operations:**

     - **read:** To retrieve a base resource that supports the specified _revincludes.
     - **search:** To search for resources that support the specified _revincludes.

   **3.4. Test Data Requirements:**

     - **Base Resource:** At least one instance of a resource type that supports the specified _revincludes. 
     - **Related Resources:**  Instances of resources that are related to the base resource through the supported _revincludes.

   **3.5. Validation Criteria:**

     **3.5.1. Capability Statement Validation:**

       - **Assertion:** The Capability Statement MUST advertise support for the specified _revincludes in the `rest.resource.searchParam` element where `name` is '_revinclude'.
       - **Pass Criteria:** The Capability Statement explicitly lists all the required _revincludes within the `documentation` field of the relevant `searchParam`.

     **3.5.2. Resource Retrieval Validation:**

       - **Assertion:** A request for a base resource using a supported _revincludes parameter MUST return a 200 OK response.
       - **Pass Criteria:** The response status code is 200 OK.

     **3.5.3. _revincludes Content Validation:**

       - **Assertion:** The returned FHIR Bundle MUST include the base resource and all related resources specified by the _revincludes parameter.
       - **Pass Criteria:** 
         - The Bundle contains the requested base resource.
         - The Bundle contains all related resources as defined by the specified _revincludes.
         - The relationships between resources are correctly represented according to the FHIR specification.

**4. Test Procedure:**

   1. Retrieve the Capability Statement from the server using the provided URL.
   2. Validate the Capability Statement against the criteria outlined in section 3.5.1.
   3. For each supported _revincludes:
      - Construct a FHIR read or search request that includes the target _revincludes parameter.
      - Send the request to the FHIR server.
      - Validate the response status code (200 OK).
      - Validate the returned FHIR Bundle against the criteria outlined in sections 3.5.2 and 3.5.3.

**5. Test Automation:**

   This test case is highly automatable.  A testing framework can be used to:

   - Programmatically retrieve and parse the Capability Statement.
   - Construct and execute FHIR API requests with various _revincludes parameters.
   - Validate the responses against the defined criteria. 


---

<a id='req-29'></a>

### REQ-29: Network profile NPI handling

**Description**: "The NPI and CLIA identifier types, which are Must-Support, are clearly intended for provider organizations only and are not expected to be populated for other organization types."

**Actor**: Server

**Conformance**: None (Clarification)

## Test Specification for REQ-29: Network profile NPI handling

### 1. Requirement ID

REQ-29

### 2. Requirement Analysis

**Testability Assessment:** Hybrid (Combination of automated data retrieval and manual assertion)

**Complexity:** Moderate

**Prerequisites:**

* Access to the target FHIR server.
* Ability to retrieve the server's CapabilityStatement.
* Ability to search for and retrieve Organization resources.

### 3. Test Implementation Strategy

This requirement necessitates a two-pronged testing approach:

**A. Automated Data Validation:**

1. **Required Inputs:** None
2. **Required FHIR Operations:**
   * `GET [base]/CapabilityStatement` - To confirm the server supports searching for Organization resources.
   * `GET [base]/Organization?identifier:system=http://hl7.org/fhir/sid/us-npi&_summary=count` - Search for Organizations with NPI identifiers.
   * `GET [base]/Organization?identifier:system=urn:oid:2.16.840.1.113883.6.259&_summary=count` - Search for Organizations with CLIA identifiers.
3. **Test Data Requirements:** No specific test data is required; the test relies on existing data on the server.
4. **Validation Criteria:**
   * **Automated Check:** Verify that the `total` count returned for each search is greater than zero. This confirms the presence of Organizations with NPI and CLIA identifiers.

**B. Manual Assertion (Clarification):**

1. **Required Inputs:** Results from the automated data validation.
2. **Required FHIR Operations:** None for this step.
3. **Test Data Requirements:**  The list of Organizations returned from the automated searches.
4. **Validation Criteria:**
   * **Manual Inspection:** For each Organization resource returned in the searches, manually inspect the `Organization.type` field. 
     * **Pass:** If all Organizations with NPI or CLIA identifiers are of a type clearly intended for provider organizations (e.g., healthcare provider, hospital, etc.).
     * **Fail:** If any Organization with an NPI or CLIA identifier is of a type not typically associated with a provider organization (e.g., insurance company, research institution, etc.).

**Reporting:**

* The test should report the results of both the automated data validation and the manual assertion. 
* If the automated checks pass but the manual inspection fails, the requirement should be marked as partially compliant with a clear explanation of the discrepancy.

**Note:** This test specification focuses on verifying the presence and appropriate use of NPI and CLIA identifiers. It does not explicitly test the "Must-Support" aspect of the requirement, which would require additional tests to ensure the server correctly handles these identifiers during create and update operations. 


---

<a id='req-30'></a>

### REQ-30: lastUpdate timestamp requirement

**Description**: "Each profile in this guide requires that the lastUpdate timestamp be provided as part of the profile's data content."

**Actor**: Server

**Conformance**: None (Requirement)

## Test Specification for REQ-30: lastUpdate Timestamp Requirement

### 1. Requirement ID

REQ-30

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Simple
* **Prerequisites:**
    * The server under test must support the FHIR RESTful API.
    * The server must have the capability to serve the profiles defined in the implementation guide.

### 3. Test Implementation Strategy

#### 3.1. Required Inputs and Expected Outputs

| Input | Expected Output |
|---|---|
| HTTP GET request to a resource instance conforming to a profile defined in the implementation guide. | HTTP 200 OK response containing the resource instance in JSON or XML format. |

#### 3.2. Required FHIR Operations

* **read:** Used to retrieve a resource instance.

#### 3.3. Test Data Requirements

* A resource instance conforming to one of the profiles defined in the implementation guide. This resource instance can be:
    * Pre-populated on the server.
    * Created by a test setup script.

#### 3.4. Validation Criteria

1. **Response Code:** Verify that the server returns an HTTP 200 OK response code.
2. **Resource Conformance:** Verify that the returned resource instance conforms to the requested profile using a FHIR validation tool.
3. **lastUpdate Presence:** Verify that the returned resource instance contains the `lastUpdate` element. This can be done by:
    * **JSON:** Checking for the presence of the `"lastUpdate"` key within the resource instance object.
    * **XML:** Checking for the presence of the `<lastUpdate>` element within the resource instance element.
4. **lastUpdate Format:** Verify that the value of the `lastUpdate` element is a valid timestamp according to the FHIR specification (YYYY-MM-DDThh:mm:ss.sss+zz:zz format).

**Passing Criteria:** The test is considered passed if all the validation criteria are met for each profile defined in the implementation guide.

**Failure Criteria:** The test is considered failed if any of the validation criteria fail for any profile defined in the implementation guide. 


---

<a id='req-32'></a>

### REQ-32: General Search for Pharmacy

**Description**: "The Plan-Net design is based around the following types of searches: General Search - Example: Pharmacy - Focal Resource and Field: HealthcareService.category, HealthcareService.specialty - Qualifications of Search: Location, network."

**Actor**: Server

**Conformance**: None (Design requirement)

## Test Specification

### 1. Requirement ID

REQ-32: General Search for Pharmacy

### 2. Requirement Analysis

**Testability Assessment:** Automatic

**Complexity:** Moderate

**Prerequisites:**

* A running FHIR server with the Plan-Net implementation.
* The FHIR server must have HealthcareService resources loaded, including some categorized as pharmacies.
* Test data should include HealthcareService resources with various combinations of `category` and `specialty` values, as well as associated `Location` resources with relevant location data.

### 3. Test Implementation Strategy

#### 3.1 Required Inputs and Expected Outputs

**Inputs:**

* **Search URL:** `[base]/HealthcareService?service-category={system | code | display}={search-value}&specialty={system | code | display}={search-value}&[location parameter]`

    * `{system | code | display}`:  Represents the search modifier for the `service-category` and `specialty` parameters. At least one must be used.
    * `{search-value}`: The value to search for within the specified element (`service-category` or `specialty`).
    * `[location parameter]`:  One of the supported location search parameters from the CapabilityStatement (e.g., `location`, `address-city`, `address-state`, etc.).

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **Resource Type:** Bundle
* **Bundle Type:** searchset
* **Bundle Entries:** HealthcareService resources that match the search criteria. This includes:
    * Matching the specified `service-category` and/or `specialty`.
    * Matching the specified location criteria.

#### 3.2 Required FHIR Operations

* **Search:**  GET request to the `[base]/HealthcareService` endpoint with the search parameters defined in the input section.

#### 3.3 Test Data Requirements

* **HealthcareService Resources:**
    * Resources representing pharmacies with various combinations of `service-category` and `specialty` values.
    * Resources with different location data associated through the `location` field.
* **Location Resources:**
    * Resources representing various geographical locations with relevant data for the chosen location search parameters.

#### 3.4 Validation Criteria

1. **Response Validation:**
    * Verify the HTTP status code is 200 (OK).
    * Verify the returned resource type is a Bundle.
    * Verify the Bundle type is `searchset`.
2. **Resource Content Validation:**
    * Verify that all returned HealthcareService resources in the Bundle:
        * Have a `service-category` and/or `specialty` that matches the search criteria.
        * Are associated with a Location resource that matches the specified location criteria.
3. **Edge Case Testing:**
    * Test with various combinations of `service-category`, `specialty`, and location search parameters.
    * Test with invalid or non-existent search values to ensure appropriate error handling.
    * Test with different search modifiers (`system`, `code`, `display`) for `service-category` and `specialty`.

**Note:** This test specification focuses on the functional requirements of REQ-32.  Additional tests might be needed to cover performance, security, and other non-functional aspects. 


---

<a id='req-33'></a>

### REQ-33: Provider search by name

**Description**: "The Plan-Net design is based around the following types of searches: Provider by Name - Example: Joe Smith - Focal Resource and Field: Practitioner.name - Qualifications of Search: Location, network, specialty, role/privileges."

**Actor**: Server

**Conformance**: None (Design requirement)

## Test Specification for REQ-33: Provider search by name

### 1. Requirement ID

REQ-33

### 2. Requirement Analysis

**Testability Assessment:** Automatic

**Complexity:** Moderate

**Prerequisites:**

* A running FHIR server with the Plan-Net implementation.
* The FHIR server must be populated with Practitioner resources.
* At least one Practitioner resource should have a name matching the search criteria ("Joe Smith" in this case).
* The server should have Location resources linked to Practitioner resources to support location-based filtering.
* The server should have data populated for other search qualifiers like network, specialty, and role/privileges.

### 3. Test Implementation Strategy

**Required Inputs:**

* **Search String:** "Joe Smith"
* **Optional Search Filters:** Location, network, specialty, role/privileges (data types depend on server implementation)

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **FHIR Bundle Resource:**  A Bundle with type 'searchset' containing Practitioner resources matching the search criteria.
* **Resource Validation:** Each returned Practitioner resource should:
    * Have a name field matching the search string ("Joe Smith" or a partial match if wildcard search is supported).
    * Match any additional search filters applied (location, network, specialty, role/privileges).

**Required FHIR Operations:**

* **Search Operation on Practitioner Resource:** 
    * URL Structure: `[base]/Practitioner?name=[search-string]&[optional-filters]`
    * Example: `[base]/Practitioner?name=Joe%20Smith&address-city=London&specialty=Cardiology`

**Test Data Requirements:**

* **Practitioner Resources:**  A set of Practitioner resources with varying names, locations, networks, specialties, and roles/privileges. 
* **Location Resources:** Location resources linked to Practitioner resources.

**Validation Criteria:**

1. **Response Code Validation:** Verify that the server returns an HTTP status code of 200 (OK).
2. **Resource Type Validation:** Verify that the returned resource is a FHIR Bundle with type 'searchset'.
3. **Search Result Validation:** 
    * Verify that the Bundle contains only Practitioner resources.
    * Verify that all returned Practitioner resources have a name field matching the search string (exact or partial match depending on search implementation).
    * Verify that all returned resources match any additional search filters applied.
4. **Negative Testing:**
    * Perform searches with non-existing names and verify that the server returns an empty Bundle or a Bundle with no matching Practitioner resources.
    * Use invalid search filter values and verify appropriate error handling.

**Note:** This test specification focuses on the core functionality of searching by name. Additional tests can be developed to cover edge cases, different search filter combinations, and error handling. 


---

<a id='req-34'></a>

### REQ-34: Organization search by name

**Description**: "The Plan-Net design is based around the following types of searches: Organization by Name - Example: Montgomery Cardiology or CVS - Focal Resource and Field: Organization.name - Qualifications of Search: Location, network, specialty."

**Actor**: Server

**Conformance**: None (Design requirement)

## Test Specification

### 1. Requirement ID

REQ-34: Organization search by name

### 2. Requirement Analysis

* **Testability Assessment:** Automatic
* **Complexity:** Simple
* **Prerequisites:** 
    * A running FHIR server with the Plan-Net implementation.
    * The FHIR server must have Organization resources loaded.
    * Test Organization resources should include variations in the `name` field. 

### 3. Test Implementation Strategy

#### 3.1. Test Case 1: Search Organization by full name

* **Test Inputs:**
    * **FHIR Operation:** GET /Organization?name=[organization name]
    * **Example:** GET /Organization?name=Montgomery Cardiology
* **Expected Outputs:**
    * **HTTP Status Code:** 200 (OK)
    * **Response Body:** A Bundle resource containing only Organization resources with the exact name "Montgomery Cardiology" in the `name` field.
* **Validation Criteria:**
    * Assert that the HTTP status code is 200.
    * Assert that the response body is a Bundle resource of type "searchset".
    * Assert that all returned Organization resources have the exact name specified in the search parameter within the `name` field.

#### 3.2. Test Case 2: Search Organization by partial name

* **Test Inputs:**
    * **FHIR Operation:** GET /Organization?name=[partial organization name]
    * **Example:** GET /Organization?name=CVS
* **Expected Outputs:**
    * **HTTP Status Code:** 200 (OK)
    * **Response Body:** A Bundle resource containing Organization resources with names that include "CVS" in the `name` field. 
* **Validation Criteria:**
    * Assert that the HTTP status code is 200.
    * Assert that the response body is a Bundle resource of type "searchset".
    * Assert that all returned Organization resources contain the string "CVS" within their `name` field.

#### 3.3. Test Case 3: Search Organization by name with no match

* **Test Inputs:**
    * **FHIR Operation:** GET /Organization?name=[non-existent organization name]
    * **Example:** GET /Organization?name=NonExistentOrg
* **Expected Outputs:**
    * **HTTP Status Code:** 200 (OK)
    * **Response Body:** An empty Bundle resource.
* **Validation Criteria:**
    * Assert that the HTTP status code is 200.
    * Assert that the response body is an empty Bundle resource of type "searchset".

#### 3.4. Test Data Requirements

* A set of Organization resources with variations in the `name` field, including full names, partial names, and names with common prefixes/suffixes.

#### 3.5. Additional Considerations

* The tests above assume a case-insensitive search. If the implementation is case-sensitive, the test cases should be adjusted accordingly.
* Consider adding test cases to validate the behavior of searching with special characters and spaces in the organization name.
* The Capability Statement confirms that the `name` search parameter is supported for the Organization resource. 


---

<a id='req-35'></a>

### REQ-35: Provider search by specialty

**Description**: "The Plan-Net design is based around the following types of searches: Provider by Specialty - Example: Cardiologist - Focal Resource and Field: PractitionerRole.specialty - Qualifications of Search: Location, network, name."

**Actor**: Server

**Conformance**: None (Design requirement)

## Test Specification

**1. Requirement ID:** REQ-35

**2. Requirement Analysis:**

* **Testability Assessment:** Automatic
* **Complexity:** Moderate
* **Prerequisites:**
    * A running FHIR server with the Plan-Net implementation.
    * Test PractitionerRole resources loaded with various specialties, locations, and network affiliations.
    * Test Practitioner resources linked to the PractitionerRole resources.
    * Test Location resources linked to the PractitionerRole resources.

**3. Test Implementation Strategy:**

* **Required Inputs:**
    * **Search Parameter:** `specialty` with a valid specialty code (e.g., `http://snomed.info/sct|394802001` for Cardiologist).
    * **Optional Search Parameters:**
        * `location`: A valid Location resource ID, city, state, or postal code.
        * `network`: A valid network identifier.
        * `name`: A Practitioner's name (family, given, or both).
* **Expected Outputs:**
    * **HTTP Status Code:** 200 (OK)
    * **Resource Type:** Bundle
    * **Bundle Type:** `searchset`
* **Required FHIR Operations:**
    * `GET /PractitionerRole?specialty={specialty}&location={location}&network={network}&name={name}`
* **Test Data Requirements:**
    * A set of PractitionerRole resources with varying combinations of specialties, locations, network affiliations, and linked Practitioner resources.
* **Validation Criteria:**
    * **Response Structure:** Verify the response is a valid FHIR Bundle with type `searchset`.
    * **Resource Type:** Ensure all returned resources are of type `PractitionerRole`.
    * **Specialty Match:** Confirm all returned PractitionerRoles have the searched specialty code.
    * **Location Filter:** If `location` is provided, verify all returned PractitionerRoles are associated with the specified location.
    * **Network Filter:** If `network` is provided, confirm all returned PractitionerRoles have the specified network affiliation.
    * **Name Filter:** If `name` is provided, ensure all returned PractitionerRoles are linked to Practitioners with matching names.
    * **Pagination:** If the results span multiple pages, test the pagination links to ensure all matching resources are retrieved.

**Note:** This test specification focuses on the "happy path" scenario. Additional tests should be implemented to cover edge cases, invalid input, and error handling. For instance, testing with invalid specialty codes, non-existent locations, or combinations of filters that return no results. 


---

<a id='req-36'></a>

### REQ-36: Organization search by specialty

**Description**: "The Plan-Net design is based around the following types of searches: Organization by specialty - Example: Compounding Pharmacy - Focal Resource and Field: OrganizationAffiliation.specialty - Qualifications of Search: Location, network, name."

**Actor**: Server

**Conformance**: None (Design requirement)

## Test Specification

### 1. Requirement ID

REQ-36: Organization search by specialty

### 2. Requirement Analysis

**Testability Assessment:** Automatic

**Complexity:** Moderate

**Prerequisites:**

* A FHIR server instance is running and accessible.
* The server exposes the Organization, Location, and OrganizationAffiliation resources with the search parameters defined in the Capability Statement.
* Test data exists in the system, including Organizations with at least one associated OrganizationAffiliation, and those OrganizationAffiliations having at least one specialty defined. 

### 3. Test Implementation Strategy

#### 3.1 Test Case 1: Search for Organizations by a single specialty

**Inputs:**

* **FHIR Operation:** GET /OrganizationAffiliation?specialty={specialtyCode}
* **Test Data:** A valid specialty code (e.g., from a controlled vocabulary like SNOMED CT) representing "Compounding Pharmacy".

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **Response Body:** A Bundle resource containing OrganizationAffiliation resources where the `specialty` field matches the provided specialty code.
* **Validation Criteria:**
    * Verify the returned Bundle conforms to FHIR standards.
    * Verify all returned OrganizationAffiliation resources have the specified `specialty` code.
    * Optionally, verify the number of returned resources matches the expected count based on pre-existing knowledge of the test data.

#### 3.2 Test Case 2: Search for Organizations by specialty with additional search parameters

**Inputs:**

* **FHIR Operation:** GET /OrganizationAffiliation?specialty={specialtyCode}&network={networkCode}&location={locationId}
* **Test Data:** 
    * A valid specialty code (e.g., from a controlled vocabulary like SNOMED CT) representing "Compounding Pharmacy".
    * A valid network code (if applicable).
    * A valid Location resource ID.

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **Response Body:** A Bundle resource containing OrganizationAffiliation resources that match all provided search criteria (specialty, network, and location).
* **Validation Criteria:**
    * Verify the returned Bundle conforms to FHIR standards.
    * Verify all returned OrganizationAffiliation resources have the specified `specialty` code, belong to the specified `network` (if provided), and are associated with the specified `location`.
    * Optionally, verify the number of returned resources matches the expected count based on pre-existing knowledge of the test data.

#### 3.3 Test Data Requirements

* A set of Organization resources with varying specialties, networks (if applicable), and locations.
* OrganizationAffiliation resources linking the Organizations to Locations and specifying their specialties and networks.
* Location resources representing geographical areas or facilities.

#### 3.4 Additional Notes

* These test cases can be further expanded to include negative testing scenarios, such as searching with invalid or non-existent specialty codes, to ensure the server handles errors gracefully.
* Performance testing can be conducted to evaluate the response time of the server for searches with varying complexity and data volumes.
* The specific codes and values used in the test data will depend on the code systems and terminologies adopted by the implementation. 


---

<a id='req-37'></a>

### REQ-37: Search for active practitioners and organizations

**Description**: "Sample query to search for currently active Practitioners (replace date in query with current date): http://davinci-plan-net-ri.logicahealth.org/fhir/PractitionerRole?_include=PractitionerRole:date=ge2021-10-25. Sample query to search for currently active Organizations (replace date in query with current date): http://davinci-plan-net-ri.logicahealth.org/fhir/OrganizationAffiliation?_include=OrganizationAffiliation:date=ge2021-10-25."

**Actor**: Server

**Conformance**: None (Implementation example)

## Test Specification

### 1. Requirement ID

REQ-37: Search for active practitioners and organizations

### 2. Requirement Analysis

**Testability Assessment:** Automatic

**Complexity:** Simple

**Prerequisites:**

* A running FHIR server with the capability to serve Practitioner, Organization, PractitionerRole, and OrganizationAffiliation resources.
* The FHIR server must support the search parameters listed in the Capability Statement for each relevant resource.
* Test data containing at least one active Practitioner and one active Organization with corresponding PractitionerRole and OrganizationAffiliation resources.

### 3. Test Implementation Strategy

#### 3.1 Test Case 1: Search for Active Practitioners

**Inputs:**

* **FHIR Operation:** GET /PractitionerRole?_include=PractitionerRole:practitioner&_lastUpdated=ge[CurrentDate]
* **CurrentDate:** The current date in YYYY-MM-DD format.

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **Response Content-Type:** application/fhir+json
* **Response Body:** A Bundle resource containing PractitionerRole resources where the `date` element is greater than or equal to the current date. The Bundle should also include the related Practitioner resources due to the `_include` parameter.

**Validation Criteria:**

1. Verify the HTTP status code is 200 (OK).
2. Verify the Content-Type header is "application/fhir+json".
3. Verify the response body is a valid Bundle resource.
4. Verify all returned PractitionerRole resources have a `date` element greater than or equal to the current date.
5. Verify the Bundle includes the related Practitioner resources for each PractitionerRole.

#### 3.2 Test Case 2: Search for Active Organizations

**Inputs:**

* **FHIR Operation:** GET /OrganizationAffiliation?_include=OrganizationAffiliation:organization&_lastUpdated=ge[CurrentDate]
* **CurrentDate:** The current date in YYYY-MM-DD format.

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **Response Content-Type:** application/fhir+json
* **Response Body:** A Bundle resource containing OrganizationAffiliation resources where the `date` element is greater than or equal to the current date. The Bundle should also include the related Organization resources due to the `_include` parameter.

**Validation Criteria:**

1. Verify the HTTP status code is 200 (OK).
2. Verify the Content-Type header is "application/fhir+json".
3. Verify the response body is a valid Bundle resource.
4. Verify all returned OrganizationAffiliation resources have a `date` element greater than or equal to the current date.
5. Verify the Bundle includes the related Organization resources for each OrganizationAffiliation.

#### 3.3 Test Data Requirements

* **Practitioner Resources:** At least one active Practitioner with a `PractitionerRole` resource linking them.
* **Organization Resources:** At least one active Organization with an `OrganizationAffiliation` resource linking them.
* **PractitionerRole Resources:** At least one resource with a `date` element greater than or equal to the current date and a reference to an active Practitioner.
* **OrganizationAffiliation Resources:** At least one resource with a `date` element greater than or equal to the current date and a reference to an active Organization.

**Note:** The `_lastUpdated` parameter is used instead of the `date` parameter as specified in the requirement. This is because the `date` parameter is not a standard search parameter for `PractitionerRole` and `OrganizationAffiliation` resources. The `_lastUpdated` parameter ensures that the resources returned are active based on their last update timestamp, which should be consistent with the intended functionality. 


---

<a id='req-38'></a>

### REQ-38: Network contact handling for departments

**Description**: "When the contact is a department name, rather than a human (e.g., patient help line), include a blank family and given name, and provide the department name in contact.name.text."

**Actor**: Server

**Conformance**: None (Implementation guidance)

## Test Specification for REQ-38: Network Contact Handling for Departments

### 1. Requirement ID

REQ-38

### 2. Requirement Analysis

- **Testability Assessment**:  Automatic
- **Complexity**: Simple
- **Prerequisites**: 
    - A FHIR server instance capable of handling Contact resources.
    - The Capability Statement of the FHIR server should indicate support for the `create` operation on the `Contact` resource.

### 3. Test Implementation Strategy

#### 3.1 Required Inputs

- A valid FHIR Contact resource representing a department contact. This resource should have:
    - `resourceType` set to "Contact"
    - Empty `name.family` and `name.given` elements
    - `name.text` populated with the department name

#### 3.2 Expected Outputs

- HTTP Status Code 200 (OK) or 201 (Created) indicating successful processing of the Contact resource.
- The returned Contact resource should match the input resource, confirming the server accepts and stores the department contact information as provided.

#### 3.3 Required FHIR Operations

- `POST` request to the `/Contact` endpoint to create a new Contact resource.

#### 3.4 Test Data Requirements

- **Example Test Data (JSON):**

```json
{
  "resourceType": "Contact",
  "name": {
    "text": "Patient Help Line"
  },
  "telecom": [
    {
      "system": "phone",
      "value": "555-123-4567"
    }
  ]
}
```

#### 3.5 Validation Criteria

1. **Response Code Validation:** Verify that the server returns an HTTP status code of 200 (OK) or 201 (Created) upon successful creation of the Contact resource.
2. **Resource Content Validation:** Verify that the returned Contact resource contains the department name in the `name.text` element and has empty `name.family` and `name.given` elements, as specified in the input.

**Note:** This test specification focuses on the successful scenario. Additional tests can be developed to cover edge cases, error handling, and different data variations to ensure comprehensive coverage of the requirement. 


---

<a id='req-39'></a>

### REQ-39: Organization contact handling for departments

**Description**: "When the contact is a department name, rather than a human (e.g., patient help line), include a blank family and given name, and provide the department name in contact.name.text."

**Actor**: Server

**Conformance**: None (Implementation guidance)

## Test Specification

### 1. Requirement ID

REQ-39: Organization contact handling for departments

### 2. Requirement Analysis

* **Testability Assessment**: Automatic
* **Complexity**: Simple
* **Prerequisites**:
    * A FHIR server instance capable of handling Organization resources.
    * The server should support the `name` search parameter for Organization resources (confirmed by Capability Statement).

### 3. Test Implementation Strategy

#### 3.1. Required Inputs and Expected Outputs

**Input**:

* A search request for Organization resources. The search request will use the `name` search parameter to target organizations with a specific department name in their contact information.

**Expected Output**:

* A Bundle resource containing Organization resources that match the search criteria.
* For each returned Organization resource representing a department:
    * The `contact.name.text` element should contain the department name.
    * The `contact.name.family` and `contact.name.given` elements should be absent or empty.

#### 3.2. Required FHIR Operations

* **Search**: This operation will be used to retrieve Organization resources based on the `name` search parameter.

#### 3.3. Test Data Requirements

* **Organization Resource**: At least one Organization resource representing a department. This resource should have:
    * A `name` element containing the department name.
    * A `contact` element with:
        * `name.text` populated with the department name.
        * `name.family` and `name.given` elements absent or empty.

#### 3.4. Validation Criteria

1. **Response Code**: The server should return a `200 OK` HTTP status code, indicating a successful search operation.
2. **Resource Type**: The response body should be a Bundle resource with type 'searchset'.
3. **Matching Resources**: The Bundle resource should contain at least one Organization resource matching the search criteria (department name).
4. **Contact Information**: For each returned Organization resource representing a department:
    * Verify that the `contact.name.text` element contains the expected department name.
    * Verify that the `contact.name.family` and `contact.name.given` elements are absent or empty.

**Example Test Case:**

1. **Test Case ID**: TC_REQ39_001
2. **Test Case Description**: Verify that searching for an Organization by department name returns the correct resource with properly formatted contact information.
3. **Test Steps**:
    1. Send a GET request to the `/Organization` endpoint with the search parameter `name={departmentName}`, where `{departmentName}` is replaced with the actual department name used in the test data.
    2. Verify the response code is `200 OK`.
    3. Verify the response body is a Bundle resource with type 'searchset'.
    4. Verify that the Bundle contains an Organization resource with the correct department name in the `name` element.
    5. For the matching Organization resource, verify that `contact.name.text` contains the department name and `contact.name.family` and `contact.name.given` are absent or empty.
4. **Expected Result**: All verification steps pass.

This test specification provides a structured approach to automatically test the implementation of REQ-39. By using specific search parameters and validation criteria, it ensures that the server correctly handles and returns Organization resources representing departments with the appropriate contact information. 


---

<a id='req-40'></a>

### REQ-40: Practitioner qualification coding

**Description**: "When the value set for the coded concept in qualification is insufficient, the qualification can be provided in the text field of the codeableConcept."

**Actor**: Server

**Conformance**: None (Implementation guidance)

## Test Specification for REQ-40: Practitioner Qualification Coding

### 1. Requirement ID

REQ-40

### 2. Requirement Analysis

* **Testability Assessment:** Hybrid (Combination of automated data retrieval and manual inspection)
* **Complexity:** Moderate
* **Prerequisites:**
    * A running FHIR server with Practitioner resources.
    * At least one Practitioner resource with a qualification where the `text` field within `codeableConcept` is used to supplement insufficient coding.

### 3. Test Implementation Strategy

#### 3.1. Test Case 1: Practitioner Qualification with Insufficient Coding and Supplemental Text

**Objective:** Verify that the server allows for the `text` field within the `codeableConcept` element of a Practitioner's qualification to provide additional information when the available coded values are insufficient.

**Inputs:**

* **FHIR Operation:**  
    * `GET [base]/Practitioner?family={familyName}` (using a known family name from the test data)
* **Test Data Requirements:** 
    * A Practitioner resource with at least one qualification where:
        * The `coding.code` field represents a value from a defined ValueSet.
        * The `coding.text` field provides additional clarifying information because the coded value alone is not sufficiently specific.

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **Response Body:** A Bundle resource containing the matching Practitioner resource(s).

**Validation Criteria:**

1. **Automated:** Validate the response is a valid Bundle resource.
2. **Manual:** Inspect the returned Practitioner resource(s) to confirm:
    * The `qualification.code.coding.text` field is populated for the target qualification.
    * The text content within the `text` field provides meaningful supplementary information that clarifies the coded value.

#### 3.2. Test Case 2: Practitioner Qualification with Sufficient Coding and No Supplemental Text (Negative Test)

**Objective:** Verify that the server does not enforce the use of the `text` field when the coded value in the `codeableConcept` is sufficient.

**Inputs:**

* **FHIR Operation:**  
    * `GET [base]/Practitioner?given={givenName}` (using a known given name from the test data)
* **Test Data Requirements:** 
    * A Practitioner resource with at least one qualification where:
        * The `coding.code` field represents a value from a defined ValueSet.
        * The coded value is sufficiently specific, and the `coding.text` field is **not** used.

**Expected Outputs:**

* **HTTP Status Code:** 200 (OK)
* **Response Body:** A Bundle resource containing the matching Practitioner resource(s).

**Validation Criteria:**

1. **Automated:** Validate the response is a valid Bundle resource.
2. **Manual:** Inspect the returned Practitioner resource(s) to confirm:
    * The `qualification.code.coding.text` field is either absent or empty for the target qualification. 

**Notes:**

* The Capability Statement confirms the server supports searching by `family` and `given` name, which are used in the test cases.
* These test cases focus on verifying the implementation guidance. Additional tests might be needed to validate the ValueSet bindings and coding system usage. 


---



